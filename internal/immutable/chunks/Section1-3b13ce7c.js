var hs=Object.defineProperty;var ds=(e,t,n)=>t in e?hs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var w=(e,t,n)=>(ds(e,typeof t!="symbol"?t+"":t,n),n);import{j as ps,O as gs,S as xt,i as Et,s as At,l as E,r as K,a as j,m as A,n as $,u as L,h as b,c as q,p as x,q as et,b as se,K as g,E as ce,I as Ve,P as xe,L as ge,v as Ke,G as Kn,J as mr,g as Ln,t as Ae,d as Fn,f as me,o as ys,Q as an,e as br,R as bn,T as Ye,w as Vt,x as jt,y as qt,B as Wt}from"./index-81fcc74e.js";import{d as Gt,r as ws}from"./index-0f02ce5e.js";function ms(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unexpected runtime environment - no supported global scope (`window`, `self`, `global`) available")}function Mn(e){if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Non array buffer passed to arrayBufferToUint8")}function bs(e,t,n){return n?`Use of '${n}' requires \`${t}\` which is unavailable on the '${e}' object within the currently executing environment.`:`\`${t}\` is unavailable on the '${e}' object within the currently executing environment.`}function je(e,{throwIfUnavailable:t,usageDesc:n,returnEmptyObject:r}={}){let i;try{if(i=ms(),i){let s=i[e];if(s)return s}}catch(s){console.error(`Error getting object '${e}' from global scope '${i}': ${s}`)}if(t){let s=bs(i,e.toString(),n);throw console.error(s),new Error(s)}if(r)return{}}function be(e){let t=e.reduce((i,s)=>i+s.length,0),n=new Uint8Array(t),r=0;for(let i=0;i<e.length;i++)n.set(e[i],r),r+=e[i].length;return n}function tt(e){return typeof e=="object"&&(e=Uint8Array.from(e)),e}function vs(e){var t;return e!==null&&typeof e=="object"&&((t=e==null?void 0:e.constructor)==null?void 0:t.wordSize)===26&&Array.isArray(e==null?void 0:e.words)}function de(e){return new TextEncoder().encode(e)}function Ss(e){return new TextDecoder().decode(e)}var qr=new Array(255);for(let e=0;e<=255;++e)qr[e]=e.toString(16).padStart(2,"0");function ae(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error(`hexToBytes: received invalid unpadded hex, got: ${e.length}`);let t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){let r=n*2;t[n]=Number.parseInt(e.slice(r,r+2),16)}return t}function W(e){let t=new Array(e.length);for(let n=0;n<e.length;++n)t[n]=qr[e[n]];return t.join("")}function yt(e){if(typeof e!="string")throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}var _t=(e,t=8)=>(typeof e=="bigint"?e:Zt(e,!1)).toString(16).padStart(t*2,"0"),xs=e=>JSON.parse(Ss(ae(e))),Es=e=>typeof e=="string"?ae(e):e,vn=e=>e.startsWith("0x")?e.replace("0x",""):e,Wr=BigInt(0),we=BigInt(1);function As(e,t=128){if(e<-(we<<BigInt(t)-we)||e>(we<<BigInt(t)-we)-we)throw`Integer out of range given ${t} bits to represent.`;return e>=Wr?e:~(-e-we|~((we<<BigInt(t))-we))}function _s(e,t=128){return(e&we<<BigInt(t)-we)>Wr&&(e=e-(we<<BigInt(t))),e}function $s(e,t=!1,n=8){return ae(_t(Zt(e,t),n))}function Zt(e,t=!1){if(typeof e=="number"){if(!Number.isInteger(e))throw new RangeError("Invalid value. Values of type 'number' must be an integer.");return BigInt(e)}if(typeof e=="string")if(e.toLowerCase().startsWith("0x")){let n=e.slice(2);n=n.padStart(n.length+n.length%2,"0"),e=ae(n)}else try{return BigInt(e)}catch(n){if(n instanceof SyntaxError)throw new RangeError(`Invalid value. String integer '${e}' is not finite.`)}if(typeof e=="bigint")return e;if(e instanceof Uint8Array)return t?_s(yt(W(e))):yt(W(e));if(vs(e))return BigInt(e.toString());throw new TypeError(`Invalid value type. Must be a number, bigint, integer-string, hex-string, BN.js instance, or Buffer, got: ${typeof e}.`)}function Is(e){return`[micro-stacks] ${e}`}var ks=class extends Error{constructor(e){super(e),this.message=Is(e),this.name=this.constructor.name}},Ts=typeof window<"u",Cs=Ts?{referrer:"no-referrer",referrerPolicy:"no-referrer"}:{};async function Ge(e,t={}){return fetch(e,{...Cs,...t})}var Gr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ns="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function Us(e){let t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");let n=e.indexOf("=");n===-1&&(n=t);let r=n===t?0:4-n%4;return[n,r]}function Bs(e,t,n){return(t+n)*3/4-n}function Os(e,t){let{revLookup:n}=zn(t),r,i=Us(e),s=i[0],o=i[1],a=new Uint8Array(Bs(e,s,o)),c=0,l=o>0?s-4:s,u;for(u=0;u<l;u+=4)r=n[e.charCodeAt(u)]<<18|n[e.charCodeAt(u+1)]<<12|n[e.charCodeAt(u+2)]<<6|n[e.charCodeAt(u+3)],a[c++]=r>>16&255,a[c++]=r>>8&255,a[c++]=r&255;return o===2&&(r=n[e.charCodeAt(u)]<<2|n[e.charCodeAt(u+1)]>>4,a[c++]=r&255),o===1&&(r=n[e.charCodeAt(u)]<<10|n[e.charCodeAt(u+1)]<<4|n[e.charCodeAt(u+2)]>>2,a[c++]=r>>8&255,a[c++]=r&255),a}function Ps(e){let t=e.length,n=t%4;if(!n)return e;let r=4-n,i=t+r;return e.padEnd(i,"=")}function wt(e){return Os(Ps(e),Gr)}function Rs(e,t){let{lookup:n}=zn(t);return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[e&63]}function Ds(e,t,n,r){let i,s=[];for(let o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(e[o+2]&255),s.push(Rs(i,r));return s.join("")}var cn=new Map;function zn(e){if(cn.has(e))return cn.get(e);let t=[],n=[];for(let r=0,i=e.length;r<i;++r)t[r]=e[r],n[e.charCodeAt(r)]=r;return n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63,cn.set(e,{lookup:t,revLookup:n}),{lookup:t,revLookup:n}}function Zr(e,t){let{lookup:n}=zn(t),r,i=e.length,s=i%3,o=[],a=16383;for(let c=0,l=i-s;c<l;c+=a)o.push(Ds(e,c,c+a>l?l:c+a,t));return s===1?(r=e[i-1],o.push(n[r>>2]+n[r<<4&63]+"==")):s===2&&(r=(e[i-2]<<8)+e[i-1],o.push(n[r>>10]+n[r>>4&63]+n[r<<2&63]+"=")),o.join("")}function Sn(e){return Zr(e,Gr)}function Jr(e){return Zr(e,Ns)}var vr="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",Sr=BigInt(58);function Hs(e){if(e.length===0)return"";typeof e=="string"&&(typeof TextEncoder<"u"?e=new TextEncoder().encode(e):e=new Uint8Array(e.split("").map(r=>r.charCodeAt(0))));let t=BigInt("0x"+W(e)),n=[];for(;t>0;){let r=Number(t%Sr);t=t/Sr,n.push(vr[r])}for(let r=0;e[r]===0;r++)n.push(vr[0]);return n.reverse().join("")}function Ks(e){let t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n)&255);return new Uint8Array(t)}function Tt(e,t,n,r,i){if(r||(r=0),!i&&i!==0&&(i=e.length),n>=t.length&&(n=t.length),n||(n=0),i>0&&i<r&&(i=r),i===r||t.length===0||e.length===0)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>e.length&&(i=e.length),t.length-n<i-r&&(i=t.length-n+r);let s=i-r;return e===t&&typeof Uint8Array.prototype.copyWithin=="function"?e.copyWithin(n,r,i):Uint8Array.prototype.set.call(t,e.subarray(r,i),n),s}var Fe=class{constructor(){w(this,"_value",[])}get value(){return this._value}appendHexString(e){this.value.push(ae(e))}push(e){return this._value.push(e)}appendByte(e){if(!Number.isInteger(e)||e<0||e>255)throw new Error(`Value ${e} is not a valid byte`);this.value.push(Uint8Array.from([e]))}concatBuffer(){return be(this.value)}};function Ct(e,t,n){return t=+t,n=n>>>0,e[n]=t&255,n+1}function Ls(e,t,n){return t=+t,n=n>>>0,e[n]=t&255,e[n+1]=t>>>8,n+2}function ln(e,t,n){return t=+t,n>>>=0,e[n+3]=t>>>24,e[n+2]=t>>>16,e[n+1]=t>>>8,e[n]=t&255,n+4}function Fs(e,t,n){return t=+t,n>>>=0,e[n]=t>>>24,e[n+1]=t>>>16,e[n+2]=t>>>8,e[n+3]=t&255,n+4}function xr(e,t){return e instanceof t||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===t.name}function Ms(e,t){if(!xr(e,Uint8Array)||!xr(t,Uint8Array))throw new TypeError('The "buf1", "buf2" arguments must be one of type Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,s=Math.min(n,r);i<s;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0}var Le=(e=>(e[e.Testnet=2147483648]="Testnet",e[e.Mainnet=1]="Mainnet",e))(Le||{}),mt=(e=>(e[e.Mainnet=0]="Mainnet",e[e.Testnet=128]="Testnet",e))(mt||{});/*! micro-base58 - MIT License (c) 2021, Paul Miller (https://paulmillr.com) */function xn(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function zs(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function Xr(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Vs(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");xn(e.outputLen),xn(e.blockLen)}function js(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function qs(e,t){Xr(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Me={number:xn,bool:zs,bytes:Xr,hash:Vs,exists:js,output:qs};/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const un=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Se=(e,t)=>e<<32-t|e>>>t,Ws=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ws)throw new Error("Non little-endian hardware is not supported");Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function En(e){if(typeof e!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}function Vn(e){if(typeof e=="string"&&(e=En(e)),!(e instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof e})`);return e}class An{clone(){return this._cloneInto()}}function $t(e){const t=r=>e().update(Vn(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Gs(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(n>>i&s),a=Number(n&s),c=r?4:0,l=r?0:4;e.setUint32(t+c,o,r),e.setUint32(t+l,a,r)}class jn extends An{constructor(t,n,r,i){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=un(this.buffer)}update(t){Me.exists(this);const{view:n,buffer:r,blockLen:i}=this;t=Vn(t);const s=t.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=un(t);for(;i<=s-o;o+=i)this.process(c,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Me.exists(this),Me.output(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:i,isLE:s}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(r,0),o=0);for(let c=o;c<i;c++)n[c]=0;Gs(r,i-8,BigInt(this.length*8),s),this.process(r,0);const a=un(t);this.get().forEach((c,l)=>a.setUint32(4*l,c,s))}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:i,finished:s,destroyed:o,pos:a}=this;return t.length=i,t.pos=a,t.finished=s,t.destroyed=o,i%n&&t.buffer.set(r),t}}const Zs=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Qr=Uint8Array.from({length:16},(e,t)=>t),Js=Qr.map(e=>(9*e+5)%16);let qn=[Qr],Wn=[Js];for(let e=0;e<4;e++)for(let t of[qn,Wn])t.push(t[e].map(n=>Zs[n]));const Yr=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>new Uint8Array(e)),Xs=qn.map((e,t)=>e.map(n=>Yr[t][n])),Qs=Wn.map((e,t)=>e.map(n=>Yr[t][n])),Ys=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),eo=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),Nt=(e,t)=>e<<t|e>>>32-t;function Er(e,t,n,r){return e===0?t^n^r:e===1?t&n|~t&r:e===2?(t|~n)^r:e===3?t&r|n&~r:t^(n|~r)}const Ut=new Uint32Array(16);class to extends jn{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:n,h2:r,h3:i,h4:s}=this;return[t,n,r,i,s]}set(t,n,r,i,s){this.h0=t|0,this.h1=n|0,this.h2=r|0,this.h3=i|0,this.h4=s|0}process(t,n){for(let d=0;d<16;d++,n+=4)Ut[d]=t.getUint32(n,!0);let r=this.h0|0,i=r,s=this.h1|0,o=s,a=this.h2|0,c=a,l=this.h3|0,u=l,f=this.h4|0,p=f;for(let d=0;d<5;d++){const y=4-d,h=Ys[d],m=eo[d],S=qn[d],v=Wn[d],_=Xs[d],T=Qs[d];for(let k=0;k<16;k++){const U=Nt(r+Er(d,s,a,l)+Ut[S[k]]+h,_[k])+f|0;r=f,f=l,l=Nt(a,10)|0,a=s,s=U}for(let k=0;k<16;k++){const U=Nt(i+Er(y,o,c,u)+Ut[v[k]]+m,T[k])+p|0;i=p,p=u,u=Nt(c,10)|0,c=o,o=U}}this.set(this.h1+a+u|0,this.h2+l+p|0,this.h3+f+i|0,this.h4+r+o|0,this.h0+s+c|0)}roundClean(){Ut.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const Ar=$t(()=>new to),no=(e,t,n)=>e&t^~e&n,ro=(e,t,n)=>e&t^e&n^t&n,io=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ue=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Be=new Uint32Array(64);class so extends jn{constructor(){super(64,32,8,!1),this.A=Ue[0]|0,this.B=Ue[1]|0,this.C=Ue[2]|0,this.D=Ue[3]|0,this.E=Ue[4]|0,this.F=Ue[5]|0,this.G=Ue[6]|0,this.H=Ue[7]|0}get(){const{A:t,B:n,C:r,D:i,E:s,F:o,G:a,H:c}=this;return[t,n,r,i,s,o,a,c]}set(t,n,r,i,s,o,a,c){this.A=t|0,this.B=n|0,this.C=r|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,n){for(let f=0;f<16;f++,n+=4)Be[f]=t.getUint32(n,!1);for(let f=16;f<64;f++){const p=Be[f-15],d=Be[f-2],y=Se(p,7)^Se(p,18)^p>>>3,h=Se(d,17)^Se(d,19)^d>>>10;Be[f]=h+Be[f-7]+y+Be[f-16]|0}let{A:r,B:i,C:s,D:o,E:a,F:c,G:l,H:u}=this;for(let f=0;f<64;f++){const p=Se(a,6)^Se(a,11)^Se(a,25),d=u+p+no(a,c,l)+io[f]+Be[f]|0,h=(Se(r,2)^Se(r,13)^Se(r,22))+ro(r,i,s)|0;u=l,l=c,c=a,a=o+d|0,o=s,s=i,i=r,r=d+h|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,i,s,o,a,c,l,u)}roundClean(){Be.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const ei=$t(()=>new so),Bt=BigInt(2**32-1),_n=BigInt(32);function ti(e,t=!1){return t?{h:Number(e&Bt),l:Number(e>>_n&Bt)}:{h:Number(e>>_n&Bt)|0,l:Number(e&Bt)|0}}function oo(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:s,l:o}=ti(e[i],t);[n[i],r[i]]=[s,o]}return[n,r]}const ao=(e,t)=>BigInt(e>>>0)<<_n|BigInt(t>>>0),co=(e,t,n)=>e>>>n,lo=(e,t,n)=>e<<32-n|t>>>n,uo=(e,t,n)=>e>>>n|t<<32-n,fo=(e,t,n)=>e<<32-n|t>>>n,ho=(e,t,n)=>e<<64-n|t>>>n-32,po=(e,t,n)=>e>>>n-32|t<<64-n,go=(e,t)=>t,yo=(e,t)=>e,wo=(e,t,n)=>e<<n|t>>>32-n,mo=(e,t,n)=>t<<n|e>>>32-n,bo=(e,t,n)=>t<<n-32|e>>>64-n,vo=(e,t,n)=>e<<n-32|t>>>64-n;function So(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:i|0}}const xo=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Eo=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,Ao=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),_o=(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,$o=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0),Io=(e,t,n,r,i,s)=>t+n+r+i+s+(e/2**32|0)|0,C={fromBig:ti,split:oo,toBig:ao,shrSH:co,shrSL:lo,rotrSH:uo,rotrSL:fo,rotrBH:ho,rotrBL:po,rotr32H:go,rotr32L:yo,rotlSH:wo,rotlSL:mo,rotlBH:bo,rotlBL:vo,add:So,add3L:xo,add3H:Eo,add4L:Ao,add4H:_o,add5H:Io,add5L:$o},[ko,To]=C.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Oe=new Uint32Array(80),Pe=new Uint32Array(80);class Gn extends jn{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:r,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:f,Fl:p,Gh:d,Gl:y,Hh:h,Hl:m}=this;return[t,n,r,i,s,o,a,c,l,u,f,p,d,y,h,m]}set(t,n,r,i,s,o,a,c,l,u,f,p,d,y,h,m){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=f|0,this.Fl=p|0,this.Gh=d|0,this.Gl=y|0,this.Hh=h|0,this.Hl=m|0}process(t,n){for(let _=0;_<16;_++,n+=4)Oe[_]=t.getUint32(n),Pe[_]=t.getUint32(n+=4);for(let _=16;_<80;_++){const T=Oe[_-15]|0,k=Pe[_-15]|0,U=C.rotrSH(T,k,1)^C.rotrSH(T,k,8)^C.shrSH(T,k,7),ee=C.rotrSL(T,k,1)^C.rotrSL(T,k,8)^C.shrSL(T,k,7),R=Oe[_-2]|0,Z=Pe[_-2]|0,G=C.rotrSH(R,Z,19)^C.rotrBH(R,Z,61)^C.shrSH(R,Z,6),O=C.rotrSL(R,Z,19)^C.rotrBL(R,Z,61)^C.shrSL(R,Z,6),N=C.add4L(ee,O,Pe[_-7],Pe[_-16]),P=C.add4H(N,U,G,Oe[_-7],Oe[_-16]);Oe[_]=P|0,Pe[_]=N|0}let{Ah:r,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:f,El:p,Fh:d,Fl:y,Gh:h,Gl:m,Hh:S,Hl:v}=this;for(let _=0;_<80;_++){const T=C.rotrSH(f,p,14)^C.rotrSH(f,p,18)^C.rotrBH(f,p,41),k=C.rotrSL(f,p,14)^C.rotrSL(f,p,18)^C.rotrBL(f,p,41),U=f&d^~f&h,ee=p&y^~p&m,R=C.add5L(v,k,ee,To[_],Pe[_]),Z=C.add5H(R,S,T,U,ko[_],Oe[_]),G=R|0,O=C.rotrSH(r,i,28)^C.rotrBH(r,i,34)^C.rotrBH(r,i,39),N=C.rotrSL(r,i,28)^C.rotrBL(r,i,34)^C.rotrBL(r,i,39),P=r&s^r&a^s&a,V=i&o^i&c^o&c;S=h|0,v=m|0,h=d|0,m=y|0,d=f|0,y=p|0,{h:f,l:p}=C.add(l|0,u|0,Z|0,G|0),l=a|0,u=c|0,a=s|0,c=o|0,s=r|0,o=i|0;const D=C.add3L(G,N,V);r=C.add3H(D,Z,O,P),i=D|0}({h:r,l:i}=C.add(this.Ah|0,this.Al|0,r|0,i|0)),{h:s,l:o}=C.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=C.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=C.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:f,l:p}=C.add(this.Eh|0,this.El|0,f|0,p|0),{h:d,l:y}=C.add(this.Fh|0,this.Fl|0,d|0,y|0),{h,l:m}=C.add(this.Gh|0,this.Gl|0,h|0,m|0),{h:S,l:v}=C.add(this.Hh|0,this.Hl|0,S|0,v|0),this.set(r,i,s,o,a,c,l,u,f,p,d,y,h,m,S,v)}roundClean(){Oe.fill(0),Pe.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class Co extends Gn{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class No extends Gn{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const Uo=$t(()=>new Gn);$t(()=>new Co);$t(()=>new No);function ue(e){return ei.create().update(tt(e)).digest()}function Bo(e){return Uo.create().update(tt(e)).digest()}const Oo={},Po=Object.freeze(Object.defineProperty({__proto__:null,default:Oo},Symbol.toStringTag,{value:"Module"}));/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */const F=BigInt(0),X=BigInt(1),ne=BigInt(2),dt=BigInt(3),Ro=BigInt(8),$n=ne**BigInt(256),Q={a:F,b:BigInt(7),P:$n-ne**BigInt(32)-BigInt(977),n:$n-BigInt("432420386565659656852420866394968145599"),h:X,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};function _r(e){const{a:t,b:n}=Q,r=I(e*e),i=I(r*e);return I(i+t*e+n)}const Ot=Q.a===F;class M{constructor(t,n,r){this.x=t,this.y=n,this.z=r}static fromAffine(t){if(!(t instanceof z))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new M(t.x,t.y,X)}static toAffineBatch(t){const n=Lo(t.map(r=>r.z));return t.map((r,i)=>r.toAffine(n[i]))}static normalizeZ(t){return M.toAffineBatch(t).map(M.fromAffine)}equals(t){if(!(t instanceof M))throw new TypeError("JacobianPoint expected");const{x:n,y:r,z:i}=this,{x:s,y:o,z:a}=t,c=I(i**ne),l=I(a**ne),u=I(n*l),f=I(s*c),p=I(I(r*a)*l),d=I(I(o*i)*c);return u===f&&p===d}negate(){return new M(this.x,I(-this.y),this.z)}double(){const{x:t,y:n,z:r}=this,i=I(t**ne),s=I(n**ne),o=I(s**ne),a=I(ne*(I((t+s)**ne)-i-o)),c=I(dt*i),l=I(c**ne),u=I(l-ne*a),f=I(c*(a-u)-Ro*o),p=I(ne*n*r);return new M(u,f,p)}add(t){if(!(t instanceof M))throw new TypeError("JacobianPoint expected");const{x:n,y:r,z:i}=this,{x:s,y:o,z:a}=t;if(s===F||o===F)return this;if(n===F||r===F)return t;const c=I(i**ne),l=I(a**ne),u=I(n*l),f=I(s*c),p=I(I(r*a)*l),d=I(I(o*i)*c),y=I(f-u),h=I(d-p);if(y===F)return h===F?this.double():M.ZERO;const m=I(y**ne),S=I(y*m),v=I(u*m),_=I(h**ne-S-ne*v),T=I(h*(v-_)-p*S),k=I(i*a*y);return new M(_,T,k)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){const n=M.ZERO;if(typeof t=="bigint"&&t===F)return n;let r=kr(t);if(r===X)return this;if(!Ot){let f=n,p=this;for(;r>F;)r&X&&(f=f.add(p)),p=p.double(),r>>=X;return f}let{k1neg:i,k1:s,k2neg:o,k2:a}=Cr(r),c=n,l=n,u=this;for(;s>F||a>F;)s&X&&(c=c.add(u)),a&X&&(l=l.add(u)),u=u.double(),s>>=X,a>>=X;return i&&(c=c.negate()),o&&(l=l.negate()),l=new M(I(l.x*Q.beta),l.y,l.z),c.add(l)}precomputeWindow(t){const n=Ot?128/t+1:256/t+1,r=[];let i=this,s=i;for(let o=0;o<n;o++){s=i,r.push(s);for(let a=1;a<2**(t-1);a++)s=s.add(i),r.push(s);i=s.double()}return r}wNAF(t,n){!n&&this.equals(M.BASE)&&(n=z.BASE);const r=n&&n._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=n&&In.get(n);i||(i=this.precomputeWindow(r),n&&r!==1&&(i=M.normalizeZ(i),In.set(n,i)));let s=M.ZERO,o=M.ZERO;const a=1+(Ot?128/r:256/r),c=2**(r-1),l=BigInt(2**r-1),u=2**r,f=BigInt(r);for(let p=0;p<a;p++){const d=p*c;let y=Number(t&l);if(t>>=f,y>c&&(y-=u,t+=X),y===0){let h=i[d];p%2&&(h=h.negate()),o=o.add(h)}else{let h=i[d+Math.abs(y)-1];y<0&&(h=h.negate()),s=s.add(h)}}return{p:s,f:o}}multiply(t,n){let r=kr(t),i,s;if(Ot){const{k1neg:o,k1:a,k2neg:c,k2:l}=Cr(r);let{p:u,f}=this.wNAF(a,n),{p,f:d}=this.wNAF(l,n);o&&(u=u.negate()),c&&(p=p.negate()),p=new M(I(p.x*Q.beta),p.y,p.z),i=u.add(p),s=f.add(d)}else{const{p:o,f:a}=this.wNAF(r,n);i=o,s=a}return M.normalizeZ([i,s])[0]}toAffine(t=it(this.z)){const{x:n,y:r,z:i}=this,s=t,o=I(s*s),a=I(o*s),c=I(n*o),l=I(r*a);if(I(i*s)!==X)throw new Error("invZ was invalid");return new z(c,l)}}M.BASE=new M(Q.Gx,Q.Gy,X);M.ZERO=new M(F,X,F);const In=new WeakMap;class z{constructor(t,n){this.x=t,this.y=n}_setWindowSize(t){this._WINDOW_SIZE=t,In.delete(this)}static fromCompressedHex(t){const n=t.length===32,r=Ee(n?t:t.subarray(1));if(!hn(r))throw new Error("Point is not on curve");const i=_r(r);let s=Ko(i);const o=(s&X)===X;n?o&&(s=I(-s)):(t[0]&1)===1!==o&&(s=I(-s));const a=new z(r,s);return a.assertValidity(),a}static fromUncompressedHex(t){const n=Ee(t.subarray(1,33)),r=Ee(t.subarray(33,65)),i=new z(n,r);return i.assertValidity(),i}static fromHex(t){const n=qe(t),r=n.length,i=n[0];if(r===32||r===33&&(i===2||i===3))return this.fromCompressedHex(n);if(r===65&&i===4)return this.fromUncompressedHex(n);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${r}`)}static fromPrivateKey(t){return z.BASE.multiply(Re(t))}static fromSignature(t,n,r){t=qe(t);const i=ni(t),{r:s,s:o}=oi(n);if(r!==0&&r!==1)throw new Error("Cannot recover signature: invalid recovery bit");const a=r&1?"03":"02",c=z.fromHex(a+ze(s)),{n:l}=Q,u=it(s,l),f=I(-i*u,l),p=I(o*u,l),d=z.BASE.multiplyAndAddUnsafe(c,f,p);if(!d)throw new Error("Cannot recover signature: point at infinify");return d.assertValidity(),d}toRawBytes(t=!1){return He(this.toHex(t))}toHex(t=!1){const n=ze(this.x);return t?`${this.y&X?"03":"02"}${n}`:`04${n}${ze(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const t="Point is not on elliptic curve",{x:n,y:r}=this;if(!hn(n)||!hn(r))throw new Error(t);const i=I(r*r),s=_r(n);if(I(i-s)!==F)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new z(this.x,I(-this.y))}double(){return M.fromAffine(this).double().toAffine()}add(t){return M.fromAffine(this).add(M.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return M.fromAffine(this).multiply(t,this).toAffine()}multiplyAndAddUnsafe(t,n,r){const i=M.fromAffine(this),s=n===F||n===X||this!==z.BASE?i.multiplyUnsafe(n):i.multiply(n),o=M.fromAffine(t).multiplyUnsafe(r),a=s.add(o);return a.equals(M.ZERO)?void 0:a.toAffine()}}z.BASE=new z(Q.Gx,Q.Gy);z.ZERO=new z(F,F);function $r(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function Ir(e){if(e.length<2||e[0]!==2)throw new Error(`Invalid signature integer tag: ${nt(e)}`);const t=e[1],n=e.subarray(2,t+2);if(!t||n.length!==t)throw new Error("Invalid signature integer: wrong length");if(n[0]===0&&n[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Ee(n),left:e.subarray(t+2)}}function Do(e){if(e.length<2||e[0]!=48)throw new Error(`Invalid signature tag: ${nt(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");const{data:t,left:n}=Ir(e.subarray(2)),{data:r,left:i}=Ir(n);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${nt(i)}`);return{r:t,s:r}}class Ce{constructor(t,n){this.r=t,this.s=n,this.assertValidity()}static fromCompact(t){const n=bt(t),r="Signature.fromCompact";if(typeof t!="string"&&!n)throw new TypeError(`${r}: Expected string or Uint8Array`);const i=n?nt(t):t;if(i.length!==128)throw new Error(`${r}: Expected 64-byte hex`);return new Ce(Ht(i.slice(0,64)),Ht(i.slice(64,128)))}static fromDER(t){const n=bt(t);if(typeof t!="string"&&!n)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r,s:i}=Do(n?t:He(t));return new Ce(r,i)}static fromHex(t){return this.fromDER(t)}assertValidity(){const{r:t,s:n}=this;if(!vt(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!vt(n))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const t=Q.n>>X;return this.s>t}normalizeS(){return this.hasHighS()?new Ce(this.r,Q.n-this.s):this}toDERRawBytes(t=!1){return He(this.toDERHex(t))}toDERHex(t=!1){const n=$r(ft(this.s));if(t)return n;const r=$r(ft(this.r)),i=ft(r.length/2),s=ft(n.length/2);return`30${ft(r.length/2+n.length/2+4)}02${i}${r}02${s}${n}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return He(this.toCompactHex())}toCompactHex(){return ze(this.r)+ze(this.s)}}function ht(...e){if(!e.every(bt))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];const t=e.reduce((r,i)=>r+i.length,0),n=new Uint8Array(t);for(let r=0,i=0;r<e.length;r++){const s=e[r];n.set(s,i),i+=s.length}return n}function bt(e){return e instanceof Uint8Array}const Ho=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function nt(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let n=0;n<e.length;n++)t+=Ho[e[n]];return t}function ze(e){if(e>$n)throw new Error("Expected number < 2^256");return e.toString(16).padStart(64,"0")}function fn(e){return He(ze(e))}function ft(e){const t=e.toString(16);return t.length&1?`0${t}`:t}function Ht(e){if(typeof e!="string")throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function He(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=n*2,i=e.slice(r,r+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[n]=s}return t}function Ee(e){return Ht(nt(e))}function qe(e){return e instanceof Uint8Array?Uint8Array.from(e):He(e)}function kr(e){if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if(typeof e=="bigint"&&vt(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function I(e,t=Q.P){const n=e%t;return n>=F?n:t+n}function pe(e,t){const{P:n}=Q;let r=e;for(;t-- >F;)r*=r,r%=n;return r}function Ko(e){const{P:t}=Q,n=BigInt(6),r=BigInt(11),i=BigInt(22),s=BigInt(23),o=BigInt(44),a=BigInt(88),c=e*e*e%t,l=c*c*e%t,u=pe(l,dt)*l%t,f=pe(u,dt)*l%t,p=pe(f,ne)*c%t,d=pe(p,r)*p%t,y=pe(d,i)*d%t,h=pe(y,o)*y%t,m=pe(h,a)*h%t,S=pe(m,o)*y%t,v=pe(S,dt)*l%t,_=pe(v,s)*d%t,T=pe(_,n)*c%t;return pe(T,ne)}function it(e,t=Q.P){if(e===F||t<=F)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=I(e,t),r=t,i=F,s=X;for(;n!==F;){const a=r/n,c=r%n,l=i-s*a;r=n,n=c,i=s,s=l}if(r!==X)throw new Error("invert: does not exist");return I(i,t)}function Lo(e,t=Q.P){const n=new Array(e.length),r=e.reduce((s,o,a)=>o===F?s:(n[a]=s,I(s*o,t)),X),i=it(r,t);return e.reduceRight((s,o,a)=>o===F?s:(n[a]=I(s*n[a],t),I(s*o,t)),i),n}const Tr=(e,t)=>(e+t/ne)/t,Pt=ne**BigInt(128);function Cr(e){const{n:t}=Q,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-X*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=n,o=Tr(s*e,t),a=Tr(-r*e,t);let c=I(e-o*n-a*i,t),l=I(-o*r-a*s,t);const u=c>Pt,f=l>Pt;if(u&&(c=t-c),f&&(l=t-l),c>Pt||l>Pt)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:u,k1:c,k2neg:f,k2:l}}function ni(e){const{n:t}=Q,r=e.length*8-256;let i=Ee(e);return r>0&&(i=i>>BigInt(r)),i>=t&&(i-=t),i}class ri{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...t){return De.hmacSha256(this.k,...t)}hmacSync(...t){throw new Error("utils.hmacSha256Sync is undefined, you need to set it")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(t=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),t),this.v=await this.hmac(this.v),t.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),t),this.v=await this.hmac(this.v))}reseedSync(t=new Uint8Array){this.k=this.hmacSync(this.v,Uint8Array.from([0]),t),this.v=this.hmacSync(this.v),t.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),t),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.incr(),this.v=this.hmacSync(this.v),this.v}}function vt(e){return F<e&&e<Q.n}function hn(e){return F<e&&e<Q.P}function ii(e,t,n){const r=Ee(e);if(!vt(r))return;const{n:i}=Q,s=z.BASE.multiply(r),o=I(s.x,i);if(o===F)return;const a=I(it(r,i)*I(t+n*o,i),i);if(a===F)return;const c=new Ce(o,a),l=(s.x===c.r?0:2)|Number(s.y&X);return{sig:c,recovery:l}}function Re(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if(typeof e=="string"){if(e.length!==64)throw new Error("Expected 32 bytes of private key");t=Ht(e)}else if(bt(e)){if(e.length!==32)throw new Error("Expected 32 bytes of private key");t=Ee(e)}else throw new TypeError("Expected valid private key");if(!vt(t))throw new Error("Expected private key: 0 < key < n");return t}function si(e){return e instanceof z?(e.assertValidity(),e):z.fromHex(e)}function oi(e){if(e instanceof Ce)return e.assertValidity(),e;try{return Ce.fromDER(e)}catch{return Ce.fromCompact(e)}}function _e(e,t=!1){return z.fromPrivateKey(e).toRawBytes(t)}function Fo(e,t,n,r=!1){return z.fromSignature(e,t,n).toRawBytes(r)}function Nr(e){const t=bt(e),n=typeof e=="string",r=(t||n)&&e.length;return t?r===33||r===65:n?r===66||r===130:e instanceof z}function ai(e,t,n=!1){if(Nr(e))throw new TypeError("getSharedSecret: first arg must be private key");if(!Nr(t))throw new TypeError("getSharedSecret: second arg must be public key");const r=si(t);return r.assertValidity(),r.multiply(Re(e)).toRawBytes(n)}function ci(e){const t=e.length>32?e.slice(0,32):e;return Ee(t)}function Mo(e){const t=ci(e),n=I(t,Q.n);return li(n<F?t:n)}function li(e){if(typeof e!="bigint")throw new Error("Expected bigint");const t=ze(e);return He(t)}function ui(e,t,n){if(e==null)throw new Error(`sign: expected valid message hash, not "${e}"`);const r=qe(e),i=Re(t),s=[li(i),Mo(r)];if(n!=null){n===!0&&(n=De.randomBytes(32));const c=qe(n);if(c.length!==32)throw new Error("sign: Expected 32 bytes of extra data");s.push(c)}const o=ht(...s),a=ci(r);return{seed:o,m:a,d:i}}function fi(e,t){let{sig:n,recovery:r}=e;const{canonical:i,der:s,recovered:o}=Object.assign({canonical:!0,der:!0},t);i&&n.hasHighS()&&(n=n.normalizeS(),r^=1);const a=s?n.toDERRawBytes():n.toCompactRawBytes();return o?[a,r]:a}async function hi(e,t,n={}){const{seed:r,m:i,d:s}=ui(e,t,n.extraEntropy);let o;const a=new ri;for(await a.reseed(r);!(o=ii(await a.generate(),i,s));)await a.reseed();return fi(o,n)}function zo(e,t,n={}){const{seed:r,m:i,d:s}=ui(e,t,n.extraEntropy);let o;const a=new ri;for(a.reseedSync(r);!(o=ii(a.generateSync(),i,s));)a.reseedSync();return fi(o,n)}const Vo={strict:!0};function Kt(e,t,n,r=Vo){let i;try{i=oi(e),t=qe(t)}catch{return!1}const{r:s,s:o}=i;if(r.strict&&i.hasHighS())return!1;const a=ni(t);let c;try{c=si(n)}catch{return!1}const{n:l}=Q,u=it(o,l),f=I(a*u,l),p=I(s*u,l),d=z.BASE.multiplyAndAddUnsafe(c,f,p);return d?I(d.x,l)===s:!1}z.BASE._setWindowSize(8);const he={node:Po,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},Ur={},De={isValidPrivateKey(e){try{return Re(e),!0}catch{return!1}},privateAdd:(e,t)=>{const n=Re(e),r=Re(t);return fn(I(n+r,Q.n))},privateNegate:e=>{const t=Re(e);return fn(Q.n-t)},pointAddScalar:(e,t,n)=>{const r=z.fromHex(e),i=Re(t),s=z.BASE.multiplyAndAddUnsafe(r,i,X);if(!s)throw new Error("Tweaked point at infinity");return s.toRawBytes(n)},pointMultiply:(e,t,n)=>{const r=z.fromHex(e),i=Ee(qe(t));return r.multiply(i).toRawBytes(n)},hashToPrivateKey:e=>{if(e=qe(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");const t=I(Ee(e),Q.n-X)+X;return fn(t)},randomBytes:(e=32)=>{if(he.web)return he.web.getRandomValues(new Uint8Array(e));if(he.node){const{randomBytes:t}=he.node;return Uint8Array.from(t(e))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>De.hashToPrivateKey(De.randomBytes(40)),bytesToHex:nt,hexToBytes:He,concatBytes:ht,mod:I,invert:it,sha256:async(...e)=>{if(he.web){const t=await he.web.subtle.digest("SHA-256",ht(...e));return new Uint8Array(t)}else if(he.node){const{createHash:t}=he.node,n=t("sha256");return e.forEach(r=>n.update(r)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(he.web){const n=await he.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),r=ht(...t),i=await he.web.subtle.sign("HMAC",n,r);return new Uint8Array(i)}else if(he.node){const{createHmac:n}=he.node,r=n("sha256",e);return t.forEach(i=>r.update(i)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let n=Ur[e];if(n===void 0){const r=await De.sha256(Uint8Array.from(e,i=>i.charCodeAt(0)));n=ht(r,r),Ur[e]=n}return De.sha256(n,...t)},taggedHashSync:(e,...t)=>{throw new Error("utils.sha256Sync is undefined, you need to set it")},precompute(e=8,t=z.BASE){const n=t===z.BASE?t:new z(t.x,t.y);return n._setWindowSize(e),n.multiply(dt),n}};var jo=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),qo=class{constructor(e){w(this,"webCrypto");this.webCrypto=e}async encrypt(e,t,n,r){let i,s;if(e==="aes-128-cbc")i="AES-CBC",s=128;else if(e==="aes-256-cbc")i="AES-CBC",s=256;else throw new Error(`Unsupported cipher algorithm "${e}"`);let o=await this.webCrypto.subtle.importKey("raw",t,{name:i,length:s},!1,["encrypt"]),a=await this.webCrypto.subtle.encrypt({name:i,iv:n},o,r);return new Uint8Array(a)}async decrypt(e,t,n,r){let i,s;if(e==="aes-128-cbc")i="AES-CBC",s=128;else if(e==="aes-256-cbc")i="AES-CBC",s=256;else throw new Error(`Unsupported cipher algorithm "${e}"`);let o=await this.webCrypto.subtle.importKey("raw",t,{name:i,length:s},!1,["decrypt"]),a=await this.webCrypto.subtle.decrypt({name:i,iv:n},o,r);return new Uint8Array(a)}},Wo=class{constructor(e,t){w(this,"createCipher");w(this,"createDecipher");this.createCipher=e,this.createDecipher=t}async encrypt(e,t,n,r){if(e!=="aes-128-cbc"&&e!=="aes-256-cbc")throw new Error(`Unsupported cipher algorithm "${e}"`);let i=this.createCipher(e,t,n),s=be([i.update(r),i.final()]);return Promise.resolve(s)}async decrypt(e,t,n,r){if(e!=="aes-128-cbc"&&e!=="aes-256-cbc")throw new Error(`Unsupported cipher algorithm "${e}"`);let i=this.createDecipher(e,t,n),s=be([i.update(r),i.final()]);return Promise.resolve(s)}};function Go(){return typeof crypto<"u"&&typeof crypto.subtle<"u"}var Zo='Crypto lib not found. Either the WebCrypto "crypto.subtle" or Node.js "crypto" module must be available.';async function Jo(){if(Go())return{lib:crypto,name:"webCrypto"};try{return{lib:jo("crypto"),name:"nodeCrypto"}}catch{throw new Error(Zo)}}async function di(){let e=await Jo();return e.name==="webCrypto"?new qo(e.lib):new Wo(e.lib.createCipheriv,e.lib.createDecipheriv)}async function Xo(e,t,n){return(await di()).encrypt("aes-256-cbc",t,e,n)}async function Qo(e,t,n){return(await di()).decrypt("aes-256-cbc",t,e,n)}class pi extends An{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,Me.hash(t);const r=Vn(n);if(this.iHash=t.create(),!(this.iHash instanceof An))throw new TypeError("Expected instance of class which extends utils.Hash");const i=this.blockLen=this.iHash.blockLen;this.outputLen=this.iHash.outputLen;const s=new Uint8Array(i);s.set(r.length>this.iHash.blockLen?t.create().update(r).digest():r);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=t.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(t){return Me.exists(this),this.iHash.update(t),this}digestInto(t){Me.exists(this),Me.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=s,t.blockLen=o,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const gi=(e,t,n)=>new pi(e,t).update(n).digest();gi.create=(e,t)=>new pi(e,t);function yi(e,...t){let n=gi.create(ei,tt(e));for(let r of t)n.update(tt(r));return Uint8Array.from(n.digest())}function Yo(e){return(Math.floor(e/16)+1)*16}function ea(e){return Math.ceil(e/3)*4}function ta(e){let t={iv:"",ephemeralPK:"",mac:"",cipherText:"",wasString:!!e.wasString};e.cipherTextEncoding==="base64"&&(t.cipherTextEncoding="base64");let n=32,r=66,i=64;return{payloadValuesLength:n+r+i,payloadShell:JSON.stringify(t)}}function na(e){let t={signature:"",publicKey:"",cipherText:e};return{signedPayloadValuesLength:144+66,signedPayloadShell:JSON.stringify(t)}}function ra(e){let{payloadShell:t,payloadValuesLength:n}=ta(e),r=Yo(e.contentLength),i;if(!e.cipherTextEncoding||e.cipherTextEncoding==="hex")i=r*2;else if(e.cipherTextEncoding==="base64")i=ea(r);else throw new Error(`Unexpected cipherTextEncoding "${e.cipherTextEncoding}"`);if(e.sign){let{signedPayloadShell:s,signedPayloadValuesLength:o}=na(t);return s.length+o+n+i}else return t.length+n+i}function ia(e){return typeof e=="string"?Ar(e):Ar.create().update(tt(e)).digest()}var sa=class{digest(e){return ia(e)}};function oa(){return new sa}function Zn(e){return oa().digest(e)}function wi(e){let t=Bo(e);return{encryptionKey:t.slice(0,32),hmacKey:t.slice(32)}}function Jn(e=32){return De.randomBytes(e)}function mi(e,t){let n=new Uint8Array([t]),r=new Uint8Array(25),i=new Uint8Array(21);i[0]=t,i.set(e,1);let s=ue(i),o=ue(s).slice(0,4);return r.set(n,0),r.set(e,1),r.set(o,e.length+1),Hs(r)}var aa={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},ca={messagePrefix:`Bitcoin Signed Message:
`,bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239},bi={bitcoin:aa,testnet:ca},Rt=(e=>(e[e.mainnetP2PKH=22]="mainnetP2PKH",e[e.mainnetP2SH=20]="mainnetP2SH",e[e.testnetP2PKH=26]="testnetP2PKH",e[e.testnetP2SH=21]="testnetP2SH",e))(Rt||{}),rt="0123456789ABCDEFGHJKMNPQRSTVWXYZ",Xn=new Map;[...rt].forEach((e,t)=>Xn.set(e,t));var Dt="0123456789abcdef",kn=new Map;[...Dt].forEach((e,t)=>kn.set(e,t));function Lt(e,t){let n=vi(e,t),r=la(be([t,n]));return`S${rt[e]}${r}`}function la(e){let t=W(e),n=[],r=0;for(let a=t.length-1;a>=0;a--)if(r<4){let c=kn.get(t[a])>>r,l=0;a!==0&&(l=kn.get(t[a-1]));let u=1+r,f=l%(1<<u)<<5-u,p=rt[c+f];r=u,n.unshift(p)}else r=0;let i=0;for(let a=0;a<n.length&&n[a]==="0";a++)i++;n=n.slice(i);let s=/^\u0000*/.exec(new TextDecoder().decode(e)),o=s?s[0].length:0;for(let a=0;a<o;a++)n.unshift(rt[0]);return n.join("")}function vi(e,t){let n=ue(be([Uint8Array.of(e),t]));return ue(n).slice(0,4)}function st(e){if(e.length<=5)throw new Error("Invalid c32 address: invalid length");if(e[0]!=="S")throw new Error('Invalid c32 address: must start with "S"');return ua(e.slice(1))}function ua(e){e=Si(e);let t=fa(e.slice(1)),n=e[0],r=Xn.get(n),i=t.slice(-4),s=vi(r,t.slice(0,-4));for(let o=0;o<i.length;o++)if(i[o]!==s[o])throw new Error("Invalid c32check string: checksum mismatch");return[r,t.slice(0,-4)]}function Si(e){return e.toUpperCase().replace(/O/g,"0").replace(/L|I/g,"1")}function fa(e){if(e=Si(e),!RegExp(`^[${rt}]*$`).exec(e))throw new Error("Not a c32-encoded string");let t=RegExp(`^${rt[0]}*`).exec(e),n=t?t[0].length:0,r=[],i=0,s=0;for(let c=e.length-1;c>=0;c--){s===4&&(r.unshift(Dt[i]),s=0,i=0);let l=(Xn.get(e[c])<<s)+i,u=Dt[l%16];if(s+=1,i=l>>4,i>1<<s)throw new Error("Panic error in decoding.");r.unshift(u)}r.unshift(Dt[i]),r.length%2===1&&r.unshift("0");let o=0;for(let c=0;c<r.length&&r[c]==="0";c++)o++;r=r.slice(o-o%2);let a=r.join("");for(let c=0;c<n;c++)a=`00${a}`;return ae(a)}function xi(e){try{return st(e),!0}catch{return!1}}function Qn(e,t=22){return Lt(t,ha(Es(e)))}function Ei(e){let t=_e(e,!0),n=ue(t),r=Zn(n);return mi(r,bi.bitcoin.pubKeyHash)}function Tn(e){let t=typeof e=="string"?e:W(e),n=ue(ae(t)),r=Zn(n);return mi(r,bi.bitcoin.pubKeyHash)}function ha(e){let t=ue(e);return Zn(t)}async function Cn(e){let{contents:t,privateKey:n}=e,r=t instanceof ArrayBuffer?Mn(t):typeof t=="string"?de(t):t,i=W(_e(n,!0)),s=ue(r),o=await hi(s,n,{canonical:!1});return{signature:W(o),publicKey:i}}function Ai(e,t=!1){let{contents:n,publicKey:r,signature:i}=e,s=n instanceof ArrayBuffer?Mn(n):typeof n=="string"?de(n):n,o=ue(s);return Kt(i,o,r,{strict:t})}async function da(e){let{publicKey:t,content:n,cipherTextEncoding:r="hex",wasString:i}=e,s=De.randomPrivateKey(),o=_e(s,!0),a=ai(s,t,!0);a=a.slice(1);let c=wi(a),l=Jn(16),u=await Xo(l,c.encryptionKey,n),f=be([l,o,u]),p=yi(c.hmacKey,f),d;if(!r||r==="hex")d=W(u);else if(r==="base64")d=Sn(u);else throw new Error(`Unexpected cipherTextEncoding "${r}"`);let y={iv:W(l),ephemeralPK:W(o),cipherText:d,mac:W(p),wasString:i};return r&&r!=="hex"&&(y.cipherTextEncoding=r),y}function pa(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}async function _i(e){let{privateKey:t,cipherObject:n}=e;if(!n.ephemeralPK)throw Error("No ephemeralPK found in cipher object");let r=n.ephemeralPK,i=ai(t,r,!0);i=i.slice(1);let s=wi(i),o=ae(n.iv),a;if(!n.cipherTextEncoding||n.cipherTextEncoding==="hex")a=ae(n.cipherText);else if(n.cipherTextEncoding==="base64")a=wt(n.cipherText);else throw new Error(`Unexpected cipherTextEncoding "${n.cipherText}"`);let c=be([o,ae(r),a]),l=yi(s.hmacKey,c),u=ae(n.mac);if(!pa(u,l))throw new Error("Decryption failed: failure in MAC check");let f=await Qo(o,s.encryptionKey,a);return n.wasString?new TextDecoder().decode(f):f}function Yn(e,t){if(!t.privateKey)throw new Error("Private key is required for decryption.");try{let n=JSON.parse(e);return _i({privateKey:t.privateKey,cipherObject:n})}catch(n){throw n instanceof SyntaxError?new Error("Failed to parse encrypted content JSON. The content may not be encrypted. If using getFile, try passing { decrypt: false }."):n}}async function $i(e,t){let{publicKey:n,privateKey:r,wasString:i}=t,{cipherTextEncoding:s,sign:o}=t;if(!r&&!n)throw new Error("Either public key or private key must be supplied for encryption.");if(!n&&r&&(n=W(_e(r,!0))),typeof i!="boolean"&&(i=typeof e=="string"),!n)throw new Error("micro-stacks/crypto - no public key found to encrypt content");let a=typeof e=="string"?de(e):e,c=await da({publicKey:n,content:a,wasString:i,cipherTextEncoding:s});if(!o)return JSON.stringify(c);if(typeof o=="string"&&(r=o),!r)throw new Error("micro-stacks/crypto - need private key to sign contents");let l=await Cn({contents:JSON.stringify(c),privateKey:r});return JSON.stringify({...l,cipherText:JSON.stringify(c)})}function ga(e){let t=e.length,n=t%4;if(!n)return e;let r=4-n,i=t+r;return e.padEnd(i,"=")}function ya(e){return e instanceof Uint8Array?Br(Sn(e)):Br(Sn(new TextEncoder().encode(e)))}function wa(e){let t=wt(ma(e));return new TextDecoder().decode(t)}function ma(e){let t;return e instanceof Uint8Array?t=new TextDecoder().decode(e):t=e,ga(t).replace(/\-/g,"+").replace(/_/g,"/")}function Br(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}var Te={encode:ya,decode:wa},Ft=128,Ii=0,ba=32,va=16,Sa=2,ki=va|ba|Ii<<6,Mt=Sa|Ii<<6;function Ti(e){return typeof e=="string"?wt(e):e}function Or(e){let t=Ti(e),n=32,r=n+1,i=t.length,s=0;if(t[s++]!==ki)throw new Error('Could not find expected "seq"');let o=t[s++];if(o===(Ft|1)&&(o=t[s++]),i-s<o)throw new Error('"seq" specified length of "'+o+'", only "'+(i-s)+'" remaining');if(t[s++]!==Mt)throw new Error('Could not find expected "int" for "r"');let a=t[s++];if(i-s-2<a)throw new Error('"r" specified length of "'+a+'", only "'+(i-s-2)+'" available');if(r<a)throw new Error('"r" specified length of "'+a+'", max of "'+r+'" is acceptable');let c=s;if(s+=a,t[s++]!==Mt)throw new Error('Could not find expected "int" for "s"');let l=t[s++];if(i-s!==l)throw new Error('"s" specified length of "'+l+'", expected "'+(i-s)+'"');if(r<l)throw new Error('"s" specified length of "'+l+'", max of "'+r+'" is acceptable');let u=s;if(s+=l,s!==i)throw new Error('Expected to consume entire buffer, but "'+(i-s)+'" bytes remain');let f=n-a,p=n-l,d=new Uint8Array(f+a+p+l);for(s=0;s<f;++s)d[s]=0;d.set(t.slice(c+Math.max(-f,0),c+a),s),s=n;for(let y=s;s<y+p;++s)d[s]=0;return d.set(t.slice(u+Math.max(-p,0),u+l),s),Jr(d).replace(/=/g,"")}function Pr(e,t,n){let r=0;for(;t+r<n&&e[t+r]===0;)++r;return e[t+r]>=Ft&&--r,r}function Rr(e){let t=Ti(e),n=32,r=Pr(t,0,n),i=Pr(t,n,t.length),s=n-r,o=n-i,a=1+1+s+1+1+o,c=a<Ft,l=new Uint8Array((c?2:3)+a),u=0;return l[u++]=ki,c?l[u++]=a:(l[u++]=Ft|1,l[u++]=a&255),l[u++]=Mt,l[u++]=s,r<0?(l[u++]=0,u+=Tt(t,l,u,0,n)):u+=Tt(t,l,u,r,n),l[u++]=Mt,l[u++]=o,i<0?(l[u++]=0,Tt(t,l,u,n)):Tt(t,l,u,n+i),Jr(l).replace(/=/g,"")}function Nn(e,t){let n=[],r=Te.encode(JSON.stringify(t));n.push(r);let i=Te.encode(JSON.stringify(e));return n.push(i),n.join(".")}var er=class{constructor(e="ES256K",t){w(this,"tokenType");w(this,"rawPrivateKey");if(!t)throw new ks("TokenSigner: rawPrivateKey is required to sign a token");this.tokenType="JWT",this.rawPrivateKey=t}header(e={}){return{typ:this.tokenType,alg:"ES256K",...e}}async sign(e,t=!1,n={}){let r=this.header(n),i=Nn(e,r),s=ue(de(i));return this.createWithSignedHash(e,t,r,i,s)}signSync(e,t=!1,n={}){let r=this.header(n),i=Nn(e,r),s=ue(de(i));return this.createWithSignedHashSync(e,t,r,i,s)}async createWithSignedHash(e,t,n,r,i){let s=await hi(i,this.rawPrivateKey,{canonical:!1}),o=Or(s);return t?{header:[Te.encode(JSON.stringify(n))],payload:JSON.stringify(e),signature:[o]}:[r,o].join(".")}createWithSignedHashSync(e,t,n,r,i){let s=zo(i,this.rawPrivateKey,{canonical:!1}),o=Or(s);return t?{header:[Te.encode(JSON.stringify(n))],payload:JSON.stringify(e),signature:[o]}:[r,o].join(".")}},xa=class{constructor(e,t){w(this,"tokenType");w(this,"rawPublicKey");this.tokenType="JWT",this.rawPublicKey=t}verify(e,t=!1){return typeof e=="string"?this.verifyCompact(e,t):typeof e=="object"?this.verifyExpanded(e,t):!1}verifyCompact(e,t){let n=e.split("."),r=n[0]+"."+n[1],i=o=>{let a=n[2],c=Rr(a);return Kt(W(wt(c)),W(o),this.rawPublicKey,{strict:t})},s=ue(de(r));return i(s)}verifyExpanded(e,t){let n=[e.header.join("."),Te.encode(e.payload)].join("."),r=!0,i=o=>(e.signature.map(a=>{let c=Rr(a);Kt(W(wt(c)),W(o),this.rawPublicKey,{strict:t})||(r=!1)}),r),s=ue(de(n));return i(s)}};function tr(e){if(typeof e=="string"){let t=e.split("."),n=JSON.parse(Te.decode(t[0])),r=JSON.parse(Te.decode(t[1])),i=t[2];return{header:n,payload:r,signature:i}}else if(typeof e=="object"){if(typeof e.payload!="string")throw new Error("Expected token payload to be a base64 or json string");let t=e.payload;e.payload[0]!=="{"&&(t=Te.decode(t));let n=[];return e.header.map(r=>{let i=JSON.parse(Te.decode(r));n.push(i)}),{header:n,payload:JSON.parse(t),signature:e.signature}}}function Ea(e){return Nn(e,{typ:"JWT",alg:"none"})+"."}var Dr=BigInt("0xffffffffffffffffffffffffffffffff"),Aa=BigInt(0);BigInt("0x7fffffffffffffffffffffffffffffff");BigInt("-170141183460469231731687303715884105728");var Jt=(e=>(e[e.Origin=1]="Origin",e[e.Standard=2]="Standard",e[e.Contract=3]="Contract",e))(Jt||{}),_a=(e=>(e[e.Int=0]="Int",e[e.UInt=1]="UInt",e[e.Buffer=2]="Buffer",e[e.BoolTrue=3]="BoolTrue",e[e.BoolFalse=4]="BoolFalse",e[e.PrincipalStandard=5]="PrincipalStandard",e[e.PrincipalContract=6]="PrincipalContract",e[e.ResponseOk=7]="ResponseOk",e[e.ResponseErr=8]="ResponseErr",e[e.OptionalNone=9]="OptionalNone",e[e.OptionalSome=10]="OptionalSome",e[e.List=11]="List",e[e.Tuple=12]="Tuple",e[e.StringASCII=13]="StringASCII",e[e.StringUTF8=14]="StringUTF8",e))(_a||{}),Ci=e=>{if(e.length>1e6)throw new Error("Cannot construct clarity buffer that is greater than 1MB");return{type:2,buffer:Uint8Array.from(e)}},nr=e=>{let t=Zt(e);if(t<Aa)throw new RangeError("Cannot construct unsigned clarity integer from negative value");if(t>Dr)throw new RangeError(`Cannot construct unsigned clarity integer greater than ${Dr.toString()}`);return{type:1,value:t}};function $a(e){return{type:11,list:e}}function Ni(){return{type:9}}function Ui(e){return{type:10,value:e}}function Ia(e){return/^[a-zA-Z]([a-zA-Z0-9]|[-_!?+<>=/*])*$|^[-+=/*]$|^[<>]=?$/.test(e)&&e.length<128}var Xt=(e=>(e[e.Address=0]="Address",e[e.Principal=1]="Principal",e[e.LengthPrefixedString=2]="LengthPrefixedString",e[e.MemoString=3]="MemoString",e[e.AssetInfo=4]="AssetInfo",e[e.PostCondition=5]="PostCondition",e[e.PublicKey=6]="PublicKey",e[e.LengthPrefixedList=7]="LengthPrefixedList",e[e.Payload=8]="Payload",e[e.MessageSignature=9]="MessageSignature",e[e.TransactionAuthField=10]="TransactionAuthField",e))(Xt||{});function Bi(e){let t=st(e);return{type:0,version:t[0],hash160:W(t[1])}}var ka=(e,t)=>e?de(e).length>t:!1;function Oi(e,t,n){let r=t||1,i=n||128;if(ka(e,i))throw new Error(`String length exceeds maximum bytes ${i.toString()}`);return{type:2,content:e,lengthPrefixBytes:r,maxLengthBytes:i}}function Qt(e){let t=new Fe;return t.appendHexString(_t(e.version,1)),t.appendHexString(e.hash160),t.concatBuffer()}function St(e){let t=new Fe,n=de(e.content),r=n.byteLength;return t.appendHexString(_t(r,e.lengthPrefixBytes)),t.push(n),t.concatBuffer()}var Hr=e=>({type:13,data:e});function Ta(e){for(let t in e)if(!Ia(t))throw new Error(`"${t}" is not a valid Clarity name`);return{type:12,data:e}}var Ca=(e=>(e[e.ClarityAbiTypeUInt128=1]="ClarityAbiTypeUInt128",e[e.ClarityAbiTypeInt128=2]="ClarityAbiTypeInt128",e[e.ClarityAbiTypeBool=3]="ClarityAbiTypeBool",e[e.ClarityAbiTypePrincipal=4]="ClarityAbiTypePrincipal",e[e.ClarityAbiTypeNone=5]="ClarityAbiTypeNone",e[e.ClarityAbiTypeBuffer=6]="ClarityAbiTypeBuffer",e[e.ClarityAbiTypeResponse=7]="ClarityAbiTypeResponse",e[e.ClarityAbiTypeOptional=8]="ClarityAbiTypeOptional",e[e.ClarityAbiTypeTuple=9]="ClarityAbiTypeTuple",e[e.ClarityAbiTypeList=10]="ClarityAbiTypeList",e[e.ClarityAbiTypeStringAscii=11]="ClarityAbiTypeStringAscii",e[e.ClarityAbiTypeStringUtf8=12]="ClarityAbiTypeStringUtf8",e[e.ClarityAbiTypeTraitReference=13]="ClarityAbiTypeTraitReference",e))(Ca||{});function $e(e,t){let n=new Fe,r=Uint8Array.from([e]);return n.push(r),n.push(t),n.concatBuffer()}function Na(e){return Uint8Array.from([e.type])}function Ua(e){return e.type===9?new Uint8Array([e.type]):$e(e.type,ot(e.value))}function Ba(e){let t=new Uint8Array(4);return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint32(t.byteOffset,e.buffer.length),$e(e.type,be([t,Uint8Array.from(e.buffer)]))}function Oa(e){let t=_t(As(e.value),16),n=ae(t);return $e(e.type,n)}function Pa(e){let t=_t(e.value,16),n=ae(t);return $e(e.type,n)}function Ra(e){return $e(e.type,Qt(e.address))}function Da(e){return $e(e.type,be([Qt(e.address),St(e.contractName)]))}function Ha(e){return $e(e.type,ot(e.value))}function Ka(e){let t=new Fe,n=new Uint8Array(4);Fs(n,e.list.length,0),t.push(n);for(let r of e.list){let i=ot(r);t.push(i)}return $e(e.type,t.concatBuffer())}function La(e){let t=[],n=new Uint8Array(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(n.byteOffset,Object.keys(e.data).length),t.push(n);let r=Object.keys(e.data).sort((i,s)=>{let o=de(i),a=de(s);return Ms(o,a)});for(let i of r){let s=Oi(i);t.push(St(s));let o=ot(e.data[i]);t.push(o)}return $e(e.type,be(t))}function Pi(e,t){let n=new Fe,r=(t==="ascii"?Ks:de)(e.data),i=new Uint8Array(4);return new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(i.byteOffset,r.length),n.push(i),n.push(r),$e(e.type,n.concatBuffer())}function Fa(e){return Pi(e,"ascii")}function Ma(e){return Pi(e,"utf8")}function ot(e){switch(e.type){case 3:case 4:return Na(e);case 9:case 10:return Ua(e);case 2:return Ba(e);case 0:return Oa(e);case 1:return Pa(e);case 5:return Ra(e);case 6:return Da(e);case 7:case 8:return Ha(e);case 11:return Ka(e);case 12:return La(e);case 13:return Fa(e);case 14:return Ma(e);default:throw new Error("Unable to serialize. Invalid Clarity Value.")}}function Un(e){return`0x${W(ot(e))}`}var za="https://stacks-node-api.mainnet.stacks.co",Va="https://stacks-node-api.testnet.stacks.co",We=class{constructor(e={url:za}){w(this,"version",mt.Mainnet);w(this,"chainId",Le.Mainnet);w(this,"broadcastEndpoint","/v2/transactions");w(this,"transferFeeEstimateEndpoint","/v2/fees/transfer");w(this,"accountEndpoint","/v2/accounts");w(this,"contractAbiEndpoint","/v2/contracts/interface");w(this,"readOnlyFunctionCallEndpoint","/v2/contracts/call-read");w(this,"bnsLookupUrl");w(this,"_coreApiUrl");w(this,"fetcher");w(this,"getCoreApiUrl",()=>this._coreApiUrl);w(this,"isMainnet",()=>this.version===mt.Mainnet);w(this,"getBroadcastApiUrl",()=>`${this.getCoreApiUrl()}${this.broadcastEndpoint}`);w(this,"getTransferFeeEstimateApiUrl",()=>`${this.getCoreApiUrl()}${this.transferFeeEstimateEndpoint}`);w(this,"getAccountApiUrl",e=>`${this.getCoreApiUrl()}${this.accountEndpoint}/${e}?proof=0`);w(this,"getAbiApiUrl",(e,t)=>`${this.getCoreApiUrl()}${this.contractAbiEndpoint}/${e}/${t}`);w(this,"getReadOnlyFunctionCallApiUrl",(e,t,n)=>`${this.getCoreApiUrl()}${this.readOnlyFunctionCallEndpoint}/${e}/${t}/${encodeURIComponent(n)}`);w(this,"getInfoUrl",()=>`${this.getCoreApiUrl()}/v2/info`);w(this,"getBlockTimeInfoUrl",()=>`${this.getCoreApiUrl()}/extended/v1/info/network_block_times`);w(this,"getPoxInfoUrl",()=>`${this.getCoreApiUrl()}/v2/pox`);w(this,"getRewardsUrl",(e,t)=>{let n=`${this.getCoreApiUrl()}/extended/v1/burnchain/rewards/${e}`;return t&&(n=`${n}?limit=${t.limit}&offset=${t.offset}`),n});w(this,"getRewardsTotalUrl",e=>`${this.getCoreApiUrl()}/extended/v1/burnchain/rewards/${e}/total`);w(this,"getRewardHoldersUrl",(e,t)=>{let n=`${this.getCoreApiUrl()}/extended/v1/burnchain/reward_slot_holders/${e}`;return t&&(n=`${n}?limit=${t.limit}&offset=${t.offset}`),n});w(this,"getStackerInfoUrl",(e,t)=>`${this.getCoreApiUrl()}${this.readOnlyFunctionCallEndpoint}
    ${e}/${t}/get-stacker-info`);if(!e.url&&!e.coreApiUrl)throw Error("[miro-stacks] Network initialized with no api url");this._coreApiUrl=e.url||e.coreApiUrl,this.bnsLookupUrl=e.bnsLookupUrl||e.url||e.coreApiUrl,this.fetcher=e.fetcher||Ge}get coreApiUrl(){return this._coreApiUrl}set coreApiUrl(e){throw new Error("Cannot modify property `coreApiUrl` after object initialization")}getNameInfo(e){let t=`${this.bnsLookupUrl}/v1/names/${e}`;return this.fetcher(t).then(n=>{if(n.status===404)throw new Error("Name not found");if(n.status!==200)throw new Error(`Bad response status: ${n.status}`);return n.json()}).then(n=>n.address?Object.assign({},n,{address:n.address}):n)}},Yt=class extends We{constructor(t={url:Va,fetcher:Ge}){super(t);w(this,"version",mt.Testnet);w(this,"chainId",Le.Testnet)}},ja=(e=>(e[e.OnChainOnly=1]="OnChainOnly",e[e.OffChainOnly=2]="OffChainOnly",e[e.Any=3]="Any",e))(ja||{});mt.Mainnet;var en=(e=>(e[e.Allow=1]="Allow",e[e.Deny=2]="Deny",e))(en||{}),qa=(e=>(e[e.STX=0]="STX",e[e.Fungible=1]="Fungible",e[e.NonFungible=2]="NonFungible",e))(qa||{}),Wa=(e=>(e[e.Standard=4]="Standard",e[e.Sponsored=5]="Sponsored",e))(Wa||{}),Ga=(e=>(e[e.SerializeP2PKH=0]="SerializeP2PKH",e[e.SerializeP2SH=1]="SerializeP2SH",e[e.SerializeP2WPKH=2]="SerializeP2WPKH",e[e.SerializeP2WSH=3]="SerializeP2WSH",e))(Ga||{}),Za=(e=>(e[e.MainnetSingleSig=22]="MainnetSingleSig",e[e.MainnetMultiSig=20]="MainnetMultiSig",e[e.TestnetSingleSig=26]="TestnetSingleSig",e[e.TestnetMultiSig=21]="TestnetMultiSig",e))(Za||{}),Ja=(e=>(e[e.Compressed=0]="Compressed",e[e.Uncompressed=1]="Uncompressed",e))(Ja||{}),rr=(e=>(e[e.Equal=1]="Equal",e[e.Greater=2]="Greater",e[e.GreaterEqual=3]="GreaterEqual",e[e.Less=4]="Less",e[e.LessEqual=5]="LessEqual",e))(rr||{}),Xa=(e=>(e[e.DoesNotOwn=16]="DoesNotOwn",e[e.Owns=17]="Owns",e))(Xa||{}),Qa=(e=>(e[e.STX=0]="STX",e[e.Fungible=1]="Fungible",e[e.NonFungible=2]="NonFungible",e))(Qa||{}),Ya=(e=>(e.Serialization="Serialization",e.Deserialization="Deserialization",e.SignatureValidation="SignatureValidation",e.FeeTooLow="FeeTooLow",e.BadNonce="BadNonce",e.NotEnoughFunds="NotEnoughFunds",e.NoSuchContract="NoSuchContract",e.NoSuchPublicFunction="NoSuchPublicFunction",e.BadFunctionArgument="BadFunctionArgument",e.ContractAlreadyExists="ContractAlreadyExists",e.PoisonMicroblocksDoNotConflict="PoisonMicroblocksDoNotConflict",e.PoisonMicroblockHasUnknownPubKeyHash="PoisonMicroblockHasUnknownPubKeyHash",e.PoisonMicroblockIsInvalid="PoisonMicroblockIsInvalid",e.BadAddressVersionByte="BadAddressVersionByte",e.NoCoinbaseViaMempool="NoCoinbaseViaMempool",e.ServerFailureNoSuchChainTip="ServerFailureNoSuchChainTip",e.ServerFailureDatabase="ServerFailureDatabase",e.ServerFailureOther="ServerFailureOther",e))(Ya||{}),ec=(e=>(e[e.TokenTransfer=0]="TokenTransfer",e[e.SmartContract=1]="SmartContract",e[e.ContractCall=2]="ContractCall",e[e.PoisonMicroblock=3]="PoisonMicroblock",e[e.Coinbase=4]="Coinbase",e))(ec||{});function tc(e,t,n){return typeof e=="string"&&(e=rc(e)),{type:Xt.PostCondition,conditionType:0,principal:e,conditionCode:t,amount:Zt(n,!1)}}function nc(e){let t=new Fe;return t.appendByte(e.conditionType),t.push(sc(e.principal)),(e.conditionType===1||e.conditionType===2)&&t.push(oc(e.assetInfo)),e.conditionType===2&&t.push(ot(e.assetName)),t.appendByte(e.conditionCode),(e.conditionType===0||e.conditionType===1)&&t.push($s(e.amount,!1,8)),t.concatBuffer()}function rc(e){if(e.includes(".")){let[t,n]=e.split(".");return ic(t,n)}else return Ri(e)}function Ri(e){return{type:Xt.Principal,prefix:Jt.Standard,address:Bi(e)}}function ic(e,t){return{type:Xt.Principal,prefix:Jt.Contract,contractName:Oi(t),address:Bi(e)}}function sc(e){let t=new Fe;return t.push(Uint8Array.from([e.prefix])),t.push(Qt(e.address)),e.prefix===Jt.Contract&&t.push(St(e.contractName)),t.concatBuffer()}function oc(e){let t=new Fe;return t.push(Qt(e.address)),t.push(St(e.contractName)),t.push(St(e.assetName)),t.concatBuffer()}var ac=(e=>(e[e.PublicKeyCompressed=0]="PublicKeyCompressed",e[e.PublicKeyUncompressed=1]="PublicKeyUncompressed",e[e.SignatureCompressed=2]="SignatureCompressed",e[e.SignatureUncompressed=3]="SignatureUncompressed",e))(ac||{});function Di(e,t,n){return tc(Ri(e),t,n)}var dn=typeof document<"u",cc=(e=>(e.SessionStorageKey="stacks-session",e.NetworkStorageKey="stacks-network",e))(cc||{}),Xe=je("localStorage",{returnEmptyObject:!0}),lc={setItem:(e,t)=>{if(dn)return Xe==null?void 0:Xe.setItem(e,t)},getItem:e=>{if(dn){let t=Xe==null?void 0:Xe.getItem(e);if(t===null)throw new Error("defaultStorageAdapter: no value stored");return t}},removeItem:e=>{if(dn)return Xe==null?void 0:Xe.removeItem(e)}},It=e=>e?W(_e(e,!0)):null;function uc(e){return e==null?void 0:e.map(t=>typeof t!="string"?W(nc(t)):t)}var ir=(e,t)=>t?new er("ES256k",t).sign(e):Ea(e),sr=async(e,t)=>{let n={...e,postConditions:uc(e.postConditions)};return ir(n,t)},fc=(e=>(e.ContractCall="contract_call",e.ContractDeploy="smart_contract",e.STXTransfer="token_transfer",e))(fc||{});async function hc({functionArgs:e,privateKey:t,...n}){let r=It(t),i={...n,functionArgs:e.map(s=>vn(typeof s=="string"?s:Un(s))),txType:"contract_call",publicKey:r};return sr(i,t)}async function dc({privateKey:e,...t}){let n={...t,publicKey:It(e),txType:"smart_contract"};return sr(n,e)}async function pc({privateKey:e,...t}){let n={...t,amount:typeof t.amount=="bigint"?Number(t.amount).toString(10):t.amount,publicKey:It(e),txType:"token_transfer"};return sr(n,e)}function gc(e){let t=e.split(":");if(t.length!==3)throw new TypeError("Decentralized IDs must have 3 parts");if(t[0].toLowerCase()!=="did")throw new TypeError('Decentralized IDs must start with "did"');return t[1].toLowerCase()}function yc(e){return e&&gc(e)==="btc-addr"?e.split(":")[2]:void 0}async function wc(e,t){let n=tr(e),r=n==null?void 0:n.payload,i;if(r.private_key)try{let s=xs(r.private_key);i=await _i({privateKey:t,cipherObject:s})}catch{console.error("[micro-stacks] failed to decrypt appPrivateKey")}return{addresses:r.profile.stxAddress,appPrivateKey:i,associationToken:r.associationToken,hubUrl:r.hubUrl,public_keys:r.public_keys,profile:r.profile,profile_url:r.profile_url,username:r.username,version:r.version,decentralizedID:r.iss,identityAddress:yc(r.iss)}}function Hi(){return je("StacksProvider",{returnEmptyObject:!1,usageDesc:"authenticate",throwIfUnavailable:!0})}async function mc(e,t=lc,n=JSON.stringify){var r,i;if(!e.appDetails)throw Error("[micro-stacks] authenticate error: `authOptions.appDetails` are required for authentication");try{let s=W(Jn()),o=await xc(e,s),a=await wc(o,s);return(r=e==null?void 0:e.onFinish)==null||r.call(e,a),t.setItem("stacks-session",n(a)),a}catch(s){(i=e==null?void 0:e.onCancel)==null||i.call(e,s.message)}}function bc(e,t){if(!e.appDetails)throw Error("[micro-stacks] authenticate error: `authOptions.appDetails` are required for authentication");let n=e.scopes||[],r=je("location",{returnEmptyObject:!0}).origin;return{scopes:[...new Set(["store_write",...n])],redirect_uri:r,public_keys:[t],domain_name:r,appDetails:e.appDetails}}async function vc(e,t){return new er("ES256k",t).sign(e)}async function Sc(e,t){let n=W(_e(t)),r=bc(e,n);return vc(r,t)}async function xc(e,t){let n=Hi();if(!n)throw Error("This function can only be called on the client, and with the presence of StacksProvider");let r=await Sc(e,t);return n.authenticationRequest(r)}function or(e){return async function(t){let{token:n,onFinish:r,onCancel:i}=t;try{let s=Hi();if(!s)throw new Error("[micro-stacks/connect] No Stacks provider");let o=s[e];if(typeof o!="function")throw new Error(`[micro-stacks/connect] StacksProvider method ${e} not found`);let a=await o(n);r==null||r(a)}catch(s){i==null||i(s==null?void 0:s.message)}}}var Ec=or("transactionRequest"),Ac=or("signatureRequest"),_c=or("structuredDataSignatureRequest"),$c=(e=>(e.Chrome="https://chrome.google.com/webstore/detail/hiro-wallet/ldinpeekobnhjjdofggfgjlcehhmanlj",e.Firefox="https://addons.mozilla.org/en-US/firefox/addon/hiro-wallet/",e.Mobile="https://www.xverse.app",e.Browser="https://www.hiro.so/wallet/install-web",e))($c||{}),Ic=async e=>{var n;let t={stxAddress:e.stxAddress,message:e.message,appDetails:(n=e.appDetails)!=null?n:null,publicKey:It(e.privateKey),network:e.network};return ir(t,e.privateKey)},kc=async e=>{try{let t=await Ic({message:e.message,network:e.network,privateKey:e.privateKey,stxAddress:e.stxAddress,authOrigin:e.authOrigin,appDetails:e.appDetails});return Ac({token:t,onFinish:e.onFinish,onCancel:e.onCancel})}catch(t){console.error("[micro-stacks] handleSignMessageRequest failed"),console.error(t)}},Tc=(e,t,n)=>Ta({name:Hr(e),version:Hr(t),"chain-id":nr(n)}),Cc=e=>{var o,a;var t;let n=typeof e.message!="string"?Un(e.message):e.message,r=Tc(e.domain.name,e.domain.version,(a=(o=e.domain.chainId)!=null?o:(t=e.network)==null?void 0:t.chainId)!=null?a:Le.Mainnet),i=Un(r),s={stxAddress:e.stxAddress,message:vn(n),domain:vn(i),appDetails:e.appDetails,publicKey:It(e.privateKey),network:e.network};return ir(s,e==null?void 0:e.privateKey)},Nc=async e=>{try{let t=await Cc({message:e.message,domain:e.domain,privateKey:e.privateKey,stxAddress:e.stxAddress,authOrigin:e.authOrigin,appDetails:e.appDetails,network:e.network});return _c({token:t,onFinish:e.onFinish,onCancel:e.onCancel})}catch(t){console.error("[micro-stacks] handleSignStructuredDataRequest failed"),console.error(t)}},Uc=9007199254740991;function Ki(e){if(e<0||e>Uc||e%1!==0)throw new RangeError("value out of range")}var Li=(e,t,n)=>{Ki(e);let r;if(t||(t=new Uint8Array(Bc(e))),!tt(t))throw new TypeError("uint8Array must be of Uint8Array type");return n||(n=0),e<253?(Ct(t,e,n),r=1):e<=65535?(Ct(t,253,n),Ls(t,e,n+1),r=3):e<=4294967295?(Ct(t,254,n),ln(t,e,n+1),r=5):(Ct(t,255,n),ln(t,e>>>0,n+1),ln(t,e/4294967296|0,n+5),r=9),Li.bytes=r,t};function Bc(e){return Ki(e),e<253?1:e<=65535?3:e<=4294967295?5:9}var Oc=`Stacks Message Signing:
`;function Fi(e){return ue(Pc(e))}function Pc(e){let t=typeof e=="string"?En(e):e,n=Li(t.length);return be([En(Oc),n,t])}var pn=32;function Rc(e){if(e.length<pn*2*2+1)throw new Error("Invalid signature");let t=e.slice(0,2),n=e.slice(2,2+pn*2),r=e.slice(2+pn*2);return{recoveryBytes:yt(t),r:n,s:r}}function Dc(e){return e.slice(-2)+e.slice(0,-2)}var Mi=({hash:e,signature:t,recoveryBytes:n})=>Fo(e,t,Number(n),!0),zi=e=>{let{signature:t,mode:n="rsv"}=e,{r,s:i,recoveryBytes:s}=Rc(n==="rsv"?Dc(t):t);return{signature:new Ce(yt(r),yt(i)),recoveryBytes:s}},Hc=e=>{if(!e.publicKey&&!e.stxAddress)throw Error("[micro-stacks/connect[ verifyMessageSignature -- You must pass `stxAddress` if you are recovering the public key from the signature");let{message:t,mode:n="rsv"}=e,r=e.publicKey;try{let i=typeof t=="string"?Fi(t):t,{signature:s,recoveryBytes:o}=zi({signature:e.signature,mode:n});if(!r){let[a]=st(e.stxAddress);r=W(Mi({hash:i,signature:s,recoveryBytes:o}));let c=Qn(r,a);if(c!==e.stxAddress)return console.error(`[micro-stacks/connect] verifyMessageSignature Stacks address is not correct. expected: ${e.stxAddress}, received: ${c}`),!1}return Kt(s,i,r,{strict:!1})}catch(i){return console.error("[micro-stacks/connect] verifyMessageSignature failed",i),!1}};const Kr=e=>{let t;const n=new Set,r=(c,l)=>{const u=typeof c=="function"?c(t):c;if(u!==t){const f=t;t=(l!=null?l:typeof u!="object")?u:Object.assign({},t,u),n.forEach(p=>p(t,f))}},i=()=>t,a={setState:r,getState:i,subscribe:c=>(n.add(c),()=>n.delete(c)),destroy:()=>n.clear()};return t=e(r,i,a),a},Kc=e=>e?Kr(e):Kr,Lc=e=>(t,n,r)=>{const i=r.subscribe;return r.subscribe=(o,a,c)=>{let l=o;if(a){const u=(c==null?void 0:c.equalityFn)||Object.is;let f=o(r.getState());l=p=>{const d=o(p);if(!u(f,d)){const y=f;a(f=d,y)}},c!=null&&c.fireImmediately&&a(f,f)}return i(l)},e(t,n,r)},Fc=Lc,zt=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(r){return zt(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return zt(r)(n)}}}},Mc=(e,t)=>(n,r,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:m=>m,version:0,merge:(m,S)=>({...S,...m}),...t},o=!1;const a=new Set,c=new Set;let l;try{l=s.getStorage()}catch{}if(!l)return e((...m)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),n(...m)},r,i);const u=zt(s.serialize),f=()=>{const m=s.partialize({...r()});let S;const v=u({state:m,version:s.version}).then(_=>l.setItem(s.name,_)).catch(_=>{S=_});if(S)throw S;return v},p=i.setState;i.setState=(m,S)=>{p(m,S),f()};const d=e((...m)=>{n(...m),f()},r,i);let y;const h=()=>{var m;if(!l)return;o=!1,a.forEach(v=>v(r()));const S=((m=s.onRehydrateStorage)==null?void 0:m.call(s,r()))||void 0;return zt(l.getItem.bind(l))(s.name).then(v=>{if(v)return s.deserialize(v)}).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==s.version){if(s.migrate)return s.migrate(v.state,v.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return v.state}).then(v=>{var _;return y=s.merge(v,(_=r())!=null?_:d),n(y,!0),f()}).then(()=>{S==null||S(y,void 0),o=!0,c.forEach(v=>v(y))}).catch(v=>{S==null||S(void 0,v)})};return i.persist={setOptions:m=>{s={...s,...m},m.getStorage&&(l=m.getStorage())},clearStorage:()=>{l==null||l.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>h(),hasHydrated:()=>o,onHydrate:m=>(a.add(m),()=>{a.delete(m)}),onFinishHydration:m=>(c.add(m),()=>{c.delete(m)})},h(),y||d},zc=Mc;var Vc=!0,gn="Invariant failed";function jc(e,t){if(!e){if(Vc)throw new Error(gn);var n=typeof t=="function"?t():t,r=n?gn+": "+n:gn;throw new Error(r)}}function qc(e){return e=Wc(e),e=Gc(e),Zc(e)}function Wc(e){let t=/(^|[^\\]);.*/g;return e.replace(t,function(n,r){return r||""})}function Gc(e){let t=[],n=/\([\s\S]*?\)/gim,r=n.exec(e);for(;r!==null;){let s=r[0].replace(/\s+/gm," ");t.push({match:r,replacement:s}),r=n.exec(e)}let i=e.split("");for(let s of t){let{match:o,replacement:a}=s;i.splice(o.index,o[0].length,a)}return i.join("").replace(/\(|\)/gim," ")}function Zc(e){let t={},n=e.split(`
`);for(let r of n){if(!r||!r.trim())continue;let i=r.toUpperCase();/\s+TXT\s+/.test(i)?(t.txt=t.txt||[],t.txt.push(nl(r))):i.indexOf("$ORIGIN")===0?t.$origin=r.split(/\s+/g)[1]:i.indexOf("$TTL")===0?t.$ttl=parseInt(r.split(/\s+/g)[1],10):/\s+SOA\s+/.test(i)?t.soa=Jc(r):/\s+NS\s+/.test(i)?(t.ns=t.ns||[],t.ns.push(Xc(r))):/\s+A\s+/.test(i)?(t.a=t.a||[],t.a.push(Qc(r,t.a))):/\s+AAAA\s+/.test(i)?(t.aaaa=t.aaaa||[],t.aaaa.push(Yc(r))):/\s+CNAME\s+/.test(i)?(t.cname=t.cname||[],t.cname.push(el(r))):/\s+MX\s+/.test(i)?(t.mx=t.mx||[],t.mx.push(tl(r))):/\s+PTR\s+/.test(i)?(t.ptr=t.ptr||[],t.ptr.push(rl(r,t.ptr,t.$origin))):/\s+SRV\s+/.test(i)?(t.srv=t.srv||[],t.srv.push(il(r))):/\s+SPF\s+/.test(i)?(t.spf=t.spf||[],t.spf.push(sl(r))):/\s+URI\s+/.test(i)&&(t.uri=t.uri||[],t.uri.push(ol(r)))}return t}function Jc(e){let t={},n=e.trim().split(/\s+/g),r=n.length;return t.name=n[0],t.minimum=parseInt(n[r-1],10),t.expire=parseInt(n[r-2],10),t.retry=parseInt(n[r-3],10),t.refresh=parseInt(n[r-4],10),t.serial=parseInt(n[r-5],10),t.rname=n[r-6],t.mname=n[r-7],isNaN(n[1])||(t.ttl=parseInt(n[1],10)),t}function Xc(e){let t=e.trim().split(/\s+/g),n=t.length,r={name:t[0],host:t[n-1]};return isNaN(t[1])||(r.ttl=parseInt(t[1],10)),r}function Qc(e,t){let n=e.trim().split(/\s+/g),r=e.trim().toUpperCase().split(/\s+/g),i=n.length,s={name:n[0],ip:n[i-1]};return r.lastIndexOf("A")===0&&(t.length?s.name=t[t.length-1].name:s.name="@"),isNaN(n[1])||(s.ttl=parseInt(n[1],10)),s}function Yc(e){let t=e.trim().split(/\s+/g),n=t.length,r={name:t[0],ip:t[n-1]};return isNaN(t[1])||(r.ttl=parseInt(t[1],10)),r}function el(e){let t=e.trim().split(/\s+/g),n=t.length,r={name:t[0],alias:t[n-1]};return isNaN(t[1])||(r.ttl=parseInt(t[1],10)),r}function tl(e){let t=e.trim().split(/\s+/g),n=t.length,r={name:t[0],preference:parseInt(t[n-2],10),host:t[n-1]};return isNaN(t[1])||(r.ttl=parseInt(t[1],10)),r}function nl(e){let t=e.trim().match(/[^\s"']+|"[^"]*"|'[^']*'/g);if(!t)throw new Error("Failure to tokenize TXT record");let n=t.length,r=t.indexOf("TXT");function i(a){return a.indexOf('"')>-1&&(a=a.split('"')[1]),a}let s;n-r-1>1?s=[...t.slice(r+1).map(i)]:s=i(t[n-1]);let o={name:t[0],txt:s};return isNaN(t[1])||(o.ttl=parseInt(t[1],10)),o}function rl(e,t,n){let r=e.trim().split(/\s+/g);e.trim().toUpperCase().split(/\s+/g).lastIndexOf("PTR")===0&&t[t.length-1]&&r.unshift(t[t.length-1].name);let i=r.length,s={name:r[0],fullname:`${r[0]}.${n}`,host:r[i-1]};return isNaN(r[1])||(s.ttl=parseInt(r[1],10)),s}function il(e){let t=e.trim().split(/\s+/g),n=t.length,r={name:t[0],target:t[n-1],priority:parseInt(t[n-4],10),weight:parseInt(t[n-3],10),port:parseInt(t[n-2],10)};return isNaN(t[1])||(r.ttl=parseInt(t[1],10)),r}function sl(e){let t=e.trim().split(/\s+/g),n={name:t[0],data:""},r=t.length;for(;r-- >4;)n.data=t[r]+" "+n.data.trim();return isNaN(t[1])||(n.ttl=parseInt(t[1],10)),n}function ol(e){let t=e.trim().split(/\s+/g),n=t.length,r={name:t[0],target:t[n-1].replace(/"/g,""),priority:parseInt(t[n-3],10),weight:parseInt(t[n-2],10)};return isNaN(t[1])||(r.ttl=parseInt(t[1],10)),r}var al=Object.defineProperty,cl=(e,t,n)=>t in e?al(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ll=(e,t,n)=>(cl(e,typeof t!="symbol"?t+"":t,n),n);function ul(e){var t;return(t=e==null?void 0:e.map(n=>({...n,domain:n.path})))!=null?t:null}function fl(e){let{hubInfo:t,privateKey:n,gaiaHubUrl:r,associationToken:i=null,scopes:s}=e,{challenge_text:o}=t,a=W(_e(n,!0)),c=Jn(16).toString();return{gaiaChallenge:o,hubUrl:r,iss:a,salt:c,associationToken:i,scopes:ul(s)}}function hl(e){let t=fl(e);return`v1:${new er("ES256K",e.privateKey).signSync(t)}`}var dl={challenge_text:'["gaiahub","0","storage2.blockstack.org","blockstack_storage_please_sign"]',latest_auth_version:"v1",max_file_upload_size_megabytes:20,read_url_prefix:"https://gaia.blockstack.org/hub/"};function pl(e){let{gaiaHubUrl:t,privateKey:n,associationToken:r,scopes:i}=e,s=dl,{read_url_prefix:o,max_file_upload_size_megabytes:a}=s,c=hl({hubInfo:s,privateKey:n,gaiaHubUrl:t,associationToken:r,scopes:i});return{address:Ei(n),url_prefix:o,token:c,server:t,max_file_upload_size_megabytes:a!=null?a:20}}var Ne={MISSING_PARAMETER:"missing_parameter",REMOTE_SERVICE_ERROR:"remote_service_error",INVALID_STATE:"invalid_state",NO_SESSION_DATA:"no_session_data",DOES_NOT_EXIST:"does_not_exist",FAILED_DECRYPTION_ERROR:"failed_decryption_error",INVALID_DID_ERROR:"invalid_did_error",NOT_ENOUGH_FUNDS_ERROR:"not_enough_error",INVALID_AMOUNT_ERROR:"invalid_amount_error",LOGIN_FAILED_ERROR:"login_failed",SIGNATURE_VERIFICATION_ERROR:"signature_verification_failure",CONFLICT_ERROR:"conflict_error",NOT_ENOUGH_PROOF_ERROR:"not_enough_proof_error",BAD_PATH_ERROR:"bad_path_error",VALIDATION_ERROR:"validation_error",PAYLOAD_TOO_LARGE_ERROR:"payload_too_large_error",PRECONDITION_FAILED_ERROR:"precondition_failed_error",UNKNOWN:"unknown"};Object.freeze(Ne);var Vi=class extends Error{constructor(t){super();w(this,"message");w(this,"code");w(this,"parameter");let n=t.message,r=`Error Code: ${t.code}`,i=this.stack;if(i)r+=`Stack Trace:
${i}`;else try{throw new Error}catch(s){i=s.stack}n+=`
If you believe this exception is caused by a bug in blockstack.js,
      please file a bug report: https://github.com/blockstack/blockstack.js/issues

${r}`,this.message=n,this.code=t.code,this.parameter=t.parameter?t.parameter:void 0}toString(){return`${super.toString()}
    code: ${this.code} param: ${this.parameter?this.parameter:"n/a"}`}},ke=class extends Vi{constructor(e){let t=`Failed to verify signature: ${e}`;super({code:Ne.SIGNATURE_VERIFICATION_ERROR,message:t}),this.message=t,this.name="SignatureVerificationError"}},Ze=class extends Vi{constructor(t,n){super(t);w(this,"hubError");n&&(this.hubError={statusCode:n.status,statusText:n.statusText},typeof n.body=="string"?this.hubError.message=n.body:typeof n.body=="object"&&Object.assign(this.hubError,n.body))}},ji=class extends Ze{constructor(e,t){super({message:e,code:Ne.DOES_NOT_EXIST},t),this.name="DoesNotExist"}},gl=class extends Ze{constructor(e,t){super({message:e,code:Ne.CONFLICT_ERROR},t),this.name="ConflictError"}},yl=class extends Ze{constructor(e,t){super({message:e,code:Ne.NOT_ENOUGH_PROOF_ERROR},t),this.name="NotEnoughProofError"}},wl=class extends Ze{constructor(e,t){super({message:e,code:Ne.BAD_PATH_ERROR},t),this.name="BadPathError"}},ml=class extends Ze{constructor(e,t){super({message:e,code:Ne.VALIDATION_ERROR},t),this.name="ValidationError"}},Bn=class extends Ze{constructor(t,n,r){super({message:t,code:Ne.PAYLOAD_TOO_LARGE_ERROR},n);w(this,"hubError");w(this,"maxUploadByteSize");this.name="PayloadTooLargeError",this.maxUploadByteSize=r}},bl=class extends Ze{constructor(e,t){super({message:e,code:Ne.PRECONDITION_FAILED_ERROR},t),this.name="PreconditionFailedError"}};async function vl(e){let t="",n;try{t=await e.text();try{n=JSON.parse(t)}catch{}}catch(s){console.debug(`Error getting bad http response text: ${s}`)}let r=e.status,i=e.statusText;return{status:r,statusText:i,body:n||t}}function qi(e){return Number.isFinite(e)?Math.floor(e*1024*1024):0}async function Wi(e,t,n){if(e.ok)throw new Error("Cannot get a Stacks from a valid response.");let r=await vl(e);if(r.status===401)throw new ml(t,r);if(r.status===402)throw new yl(t,r);if(r.status===403)throw new wl(t,r);if(r.status===404)throw new ji(t,r);if(r.status===409)throw new gl(t,r);if(r.status===412)throw new bl(t,r);if(r.status===413){let i=n&&n.max_file_upload_size_megabytes?qi(n.max_file_upload_size_megabytes):0;throw new Bn(t,r,i)}else throw new Error(t)}function Sl(e){if(!e||!e.hubError||!e.hubError.statusCode)return!1;let t=e.hubError.statusCode;return t===401||t===409||t>=500&&t<=599}async function yn(e){let{filename:t,contents:n,hubConfig:r,contentType:i="application/octet-stream"}=e,s={"Content-Type":i,Authorization:`bearer ${r.token}`},o=await Ge(`${r.server}/store/${r.address}/${t}`,{method:"POST",headers:s,body:n});if(!o.ok)throw await Wi(o,"Error when uploading to Gaia hub.",r);let a=await o.text();return JSON.parse(a)}function Gi(e,t){return Promise.resolve(`${t.url_prefix}${t.address}/${e}`)}var Qe=".sig",Zi="https://stacks-node-api.stacks.co/v1/names",Ji=class{constructor(e,t){w(this,"content");w(this,"wasString");w(this,"contentType");w(this,"contentByteLength");w(this,"loadedData");this.wasString=typeof e=="string",this.content=Ji.normalizeContentDataType(e,t),this.contentType=t||this.detectContentType(),this.contentByteLength=this.detectContentLength()}static normalizeContentDataType(e,t){try{if(typeof e=="string"){let n=(t||"").toLowerCase().replace("-","");if(n.includes("charset")&&!n.includes("charset=utf8")&&!n.includes("charset=ascii"))throw new Error(`Unable to determine byte length with charset: ${t}`);return new TextEncoder().encode(e)}else{if(e instanceof Uint8Array)return e;if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);if(typeof Blob<"u"&&e instanceof Blob)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(Array.isArray(e)){if(e.length>0&&(!Number.isInteger(e[0])||e[0]<0||e[0]>255))throw new Error(`Unexpected array values provided as file data: value "${e[0]}" at index 0 is not an octet number. ${this.supportedTypesMsg}`);return new Uint8Array(e)}else{let n=Object.prototype.toString.call(e);throw new Error(`Unexpected type provided as file data: ${n}. ${this.supportedTypesMsg}`)}}}catch(n){throw console.error(n),new Error(`Error processing data: ${n}`)}}detectContentType(){return this.wasString?"text/plain; charset=utf-8":typeof Blob<"u"&&this.content instanceof Blob&&this.content.type?this.content.type:"application/octet-stream"}detectContentLength(){if(ArrayBuffer.isView(this.content)||this.content instanceof Uint8Array)return this.content.byteLength;if(typeof Blob<"u"&&this.content instanceof Blob)return this.content.size;let e=Object.prototype.toString.call(this.content),t=new Error(`Unexpected type "${e}" while detecting content length`);throw console.error(t),t}async loadContent(){try{if(this.content instanceof Uint8Array)return this.content;if(ArrayBuffer.isView(this.content))return new Uint8Array(this.content.buffer,this.content.byteOffset,this.content.byteLength);if(typeof Blob<"u"&&this.content instanceof Blob){let e=new FileReader;return await new Promise((t,n)=>{e.onerror=r=>{n(r)},e.onload=()=>{let r=e.result;t(new Uint8Array(r))},e.readAsArrayBuffer(this.content)})}else{let e=Object.prototype.toString.call(this.content);throw new Error(`Unexpected type ${e}`)}}catch(e){console.error(e);let t=new Error(`Error loading content: ${e}`);throw console.error(t),t}}load(){return this.loadedData===void 0&&(this.loadedData=this.loadContent()),this.loadedData}},Xi=Ji;ll(Xi,"supportedTypesMsg","Supported types are: `string` (to be UTF8 encoded), `Uint8Array`, `Blob`, `File`, `ArrayBuffer`, `UInt8Array` or any other typed array buffer. ");async function xl(e,t,n){let{privateKey:r}=n,{encrypt:i,sign:s,gaiaHubConfig:o,cipherTextEncoding:a}=n,{contentType:c=""}=n,l=qi(o.max_file_upload_size_megabytes),u=l>0,f=new Xi(t,c);if(c=f.contentType,!i&&u&&f.contentByteLength>l){let d=`The max file upload size for this hub is ${l} bytes, the given content is ${f.contentByteLength} bytes`,y=new Bn(d,null,l);throw console.error(y),y}if(i&&u&&a){let d=ra({contentLength:f.contentByteLength,wasString:f.wasString,sign:!!s,cipherTextEncoding:a});if(d>l){let y=`The max file upload size for this hub is ${l} bytes, the given content is ${d} bytes after encryption`,h=new Bn(y,null,l);throw console.error(h),h}}let p;if(!i&&s){let d=await f.load();if(typeof s=="string")r=s;else if(!r)throw Error("Need to pass private key");let y=await Cn({contents:d,privateKey:r});p=async h=>(await Promise.all([yn({filename:e,contents:d,hubConfig:h,contentType:c}),yn({filename:`${e}${Qe}`,contents:JSON.stringify(y),hubConfig:h,contentType:"application/json"})]))[0].publicURL}else{let d;if(!i&&!s)d=f.content;else{let y;if(typeof i=="string")y=i;else if(typeof s=="string")y=W(_e(s,!0));else if(r)y=W(_e(r,!0));else throw new Error("No private key passed");let h=await f.load(),m=await $i(h,{publicKey:y,wasString:f.wasString,cipherTextEncoding:a,privateKey:r});if(d=JSON.stringify(m),r){let{signature:S,publicKey:v}=await Cn({contents:m,privateKey:r});d=JSON.stringify({signature:S,publicKey:v,cipherText:m})}c="application/json"}p=async y=>(await yn({filename:e,contents:d,hubConfig:y,contentType:c})).publicURL}try{return await p(o)}catch(d){if(Sl(d))return console.error(d),console.error("Possible recoverable error during Gaia upload, retrying..."),await p(o);throw d}}function El(e){if(!e.hasOwnProperty("uri")||!Array.isArray(e.uri)||e.uri.length<1)return null;let t=e.uri[0];if(!t.hasOwnProperty("target"))return null;let n=t.target;return n.startsWith("https")||n.startsWith("http")||(n=`https://${n}`),n}function wn(e,t){let n;return t.proof&&t.proof.url&&(n=t.proof.url),{"@type":"Account",service:e,identifier:t.username,proofType:"http",proofUrl:n}}function Al(e){let t={"@type":"Person"};if(e){e.name&&e.name.formatted&&(t.name=e.name.formatted),e.bio&&(t.description=e.bio),e.location&&e.location.formatted&&(t.address={"@type":"PostalAddress",addressLocality:e.location.formatted});let n=[];e.avatar&&e.avatar.url&&n.push({"@type":"ImageObject",name:"avatar",contentUrl:e.avatar.url}),e.cover&&e.cover.url&&n.push({"@type":"ImageObject",name:"cover",contentUrl:e.cover.url}),n.length&&(t.image=n),e.website&&(t.website=[{"@type":"WebSite",url:e.website}]);let r=[];e.bitcoin&&e.bitcoin.address&&r.push({"@type":"Account",role:"payment",service:"bitcoin",identifier:e.bitcoin.address}),e.twitter&&e.twitter.username&&r.push(wn("twitter",e.twitter)),e.facebook&&e.facebook.username&&r.push(wn("facebook",e.facebook)),e.github&&e.github.username&&r.push(wn("github",e.github)),e.auth&&e.auth.length>0&&e.auth[0]&&e.auth[0].publicKeychain&&r.push({"@type":"Account",role:"key",service:"bip32",identifier:e.auth[0].publicKeychain}),e.pgp&&e.pgp.url&&r.push({"@type":"Account",role:"key",service:"pgp",identifier:e.pgp.fingerprint,contentUrl:e.pgp.url}),t.account=r}return t}function _l(e,t){let n=tr(e);if(!n)throw Error("no decoded token");let r=n.payload;if(typeof r=="string")throw new Error("Unexpected token payload type of string");if(r.hasOwnProperty("subject")&&r.subject){if(!r.subject.hasOwnProperty("publicKey"))throw new Error("Token doesn't have a subject public key")}else throw new Error("Token doesn't have a subject");if(r.hasOwnProperty("issuer")&&r.issuer){if(!r.issuer.hasOwnProperty("publicKey"))throw new Error("Token doesn't have an issuer public key")}else throw new Error("Token doesn't have an issuer");if(!r.hasOwnProperty("claim"))throw new Error("Token doesn't have a claim");let i=r.issuer.publicKey,s=Qn(i);if(t!==i&&t!==s)throw new Error("Token issuer public key does not match the verifying value");let o=new xa(n.header.alg,i);if(!o)throw new Error("Invalid token verifier");if(!o.verify(e))throw new Error("Token verification failed");return n}function $l(e,t){let n=t?_l(e,t):tr(e);if(n&&n.hasOwnProperty("payload")){let r=n.payload;if(typeof r=="string")throw new Error("[micro-stacks] extractProfile: Unexpected token payload type of string");if(r.hasOwnProperty("claim"))return r.claim}return{}}async function Il(e,t){let n=qc(e);if(n.hasOwnProperty("$origin")||(n=null),!(n&&Object.keys(n).length>0))return Al(JSON.parse(e));let r=El(n);if(r)try{let i=await(await Ge(r)).json();return $l(i[0].token,t)}catch(i){throw console.error(`[micro-stacks] resolveZoneFileToProfile: error fetching token file ${r}: ${i}`),i}return console.debug("[micro-stacks] Token file url not found. Resolving to blank profile."),{}}async function kl(e){let{username:t,zoneFileLookupURL:n=Zi}=e;if(!t)return Promise.reject();let r=`${n.replace(/\/$/,"")}/${e.username}`,i=await(await Ge(r)).json();if(i.hasOwnProperty("zonefile")&&i.hasOwnProperty("address"))return await Il(i.zonefile,e.verify?i.address:void 0);throw new Error("Invalid zonefile lookup response: did not contain `address` or `zonefile` field")}async function Qi(e,t,n,r){let i=await kl({username:t,zoneFileLookupURL:r}),s;if(i)return i.hasOwnProperty("apps")?i.apps.hasOwnProperty(n)&&(s=`${i.apps[n].replace(/\/?(\?|#|$)/,"/$1")}${e}`):i.hasOwnProperty("appsMeta")&&i.appsMeta.hasOwnProperty(n)&&(s=`${i.appsMeta[n].replace(/\/?(\?|#|$)/,"/$1")}${e}`),s}async function Tl(e,t){let n;if(t.username?n=await Qi(e,t.username,t.app,t.zoneFileLookupURL):n=await Gi(e,t.gaiaHubConfig),n)return n;throw new Error("Missing readURL")}async function Yi(e){let{app:t,username:n,zoneFileLookupURL:r,gaiaHubConfig:i}=e,s;n?s=await Qi("/",n,t,r):i&&(s=await Gi("/",i));let o=/([13][a-km-zA-HJ-NP-Z0-9]{26,35})/.exec(s);if(!o)throw new Error("Failed to parse gaia address");return o[o.length-1]}async function On(e){let{path:t,forceText:n,app:r,username:i,zoneFileLookupURL:s,gaiaHubConfig:o}=e,a=await Tl(t,{app:r,username:i,zoneFileLookupURL:s,gaiaHubConfig:o}),c=await Ge(a);if(!c.ok)throw await Wi(c,`getFile ${t} failed.`,null);let l=c.headers.get("Content-Type");if(typeof l=="string"&&(l=l.toLowerCase()),n||l===null||l.startsWith("text")||l.startsWith("application/json"))return c.text();{let u=await c.arrayBuffer();return Mn(u)}}async function Cl(e,t){let{app:n,username:r,zoneFileLookupURL:i,gaiaHubConfig:s}=t,o=`${e}${Qe}`;try{let[a,c,l]=await Promise.all([On({path:e,app:n,username:r,zoneFileLookupURL:i,forceText:!1,gaiaHubConfig:s}),On({path:o,app:n,username:r,zoneFileLookupURL:i,forceText:!0,gaiaHubConfig:s}),Yi({app:n,username:r,zoneFileLookupURL:i,gaiaHubConfig:s})]);if(!a)return a;if(!l)throw new ke(`Failed to get gaia address for verification of: ${e}`);if(!c||typeof c!="string")throw new ke(`Failed to obtain signature for file: ${e} -- looked in ${e}${Qe}`);let u,f;try{let h=JSON.parse(c);u=h.signature,f=h.publicKey}catch(h){throw h instanceof SyntaxError?new Error(`Failed to parse signature content JSON (path: ${e}${Qe}) The content may be corrupted.`):h}let p=Tn(f),d=typeof a=="string"?de(a):a,y=Ai({signature:u,contents:d,publicKey:f});if(l!==p)throw new ke(`Signer pubkey address (${p}) doesn't match gaia address (${l})`);if(y)return a;throw new ke(`Contents do not match ECDSA signature: path: ${e}, signature: ${e}${Qe}`)}catch(a){throw a instanceof ji&&a.message.indexOf(o)>=0?new ke(`Failed to obtain signature for file: ${e} -- looked in ${e}${Qe}`):a}}async function Nl(e){let{path:t,storedContents:n,app:r,privateKey:i,username:s,zoneFileLookupURL:o,gaiaHubConfig:a}=e,c=i,l=c?_e(c,!0):null,u=null;if(s||a?u=await Yi({app:r,username:s,zoneFileLookupURL:o,gaiaHubConfig:a}):l&&(u=Tn(l)),!u)throw new ke(`Failed to get gaia address for verification of: ${t}`);let f;try{f=JSON.parse(n)}catch(m){throw m instanceof SyntaxError?new Error("Failed to parse encrypted, signed content JSON. The content may not be encrypted. If using getFile, try passing { verify: false, decrypt: false }."):m}let p=f.signature,d=f.publicKey,y=f.cipherText,h=Tn(d);if(!d||!y||!p)throw new ke(`Failed to get signature verification data from file: ${t}`);if(h!==u)throw new ke(`Signer pubkey address (${h}) doesn't match gaia address (${u})`);if(!Ai({signature:p,contents:y,publicKey:d}))throw new ke(`Contents do not match ECDSA signature in file: ${t}`);if(!i)throw Error("Private key needs to be passed in order to decrypt content");return Yn(y,{privateKey:i})}async function Ul(e,t){let n={decrypt:!0,verify:!1,app:je("location",{returnEmptyObject:!0}).origin,zoneFileLookupURL:Zi,...t};if(n.verify&&!n.decrypt)return Cl(e,n);let r=await On({path:e,app:n.app,username:n.username,zoneFileLookupURL:n.zoneFileLookupURL,forceText:!!n.decrypt,gaiaHubConfig:n.gaiaHubConfig});if(r===null)return r;if(typeof r!="string")throw new Error("[micro-stacks/storage] Expected to get back a string for the cipherText");let i=!!n.verify,s=!!n.decrypt,o=typeof n.decrypt=="string"?n.decrypt:n.privateKey;if(r.includes("signature")&&r.includes("publicKey")&&(i=!0),r.includes("cipherText")&&r.includes("ephemeralPK")&&(s=!0),!i&&!s)return r;let a=!r.includes("cipherText");if(s&&a)throw new Error(`[micro-stacks/storage] Expected to get back a string that includes cipherText, is it encrypted? got back: ${JSON.stringify(r)}`);if(!o)throw new Error("[micro-stacks/storage] No private key was passed to getFile, a private key needs to be passed if decrypt is set to true");if(!i)return Yn(r,{privateKey:o});if(s&&i)return Nl({path:e,storedContents:r,app:n.app,privateKey:o,username:n.username,zoneFileLookupURL:n.zoneFileLookupURL,gaiaHubConfig:n.gaiaHubConfig});throw new Error("[micro-stacks/storage] Should be unreachable.")}function Bl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var at=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!e(t[i],n[i]))return!1;return!0}if(t instanceof Map&&n instanceof Map){if(t.size!==n.size)return!1;for(i of t.entries())if(!n.has(i[0]))return!1;for(i of t.entries())if(!e(i[1],n.get(i[0])))return!1;return!0}if(t instanceof Set&&n instanceof Set){if(t.size!==n.size)return!1;for(i of t.entries())if(!n.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(n)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(t[i]!==n[i])return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(s=Object.keys(t),r=s.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;i--!==0;){var o=s[i];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n},Ol="micro-stacks",es={getItem:e=>null,setItem:(e,t)=>{},removeItem:e=>{}},ts=Pl({storage:typeof window<"u"?window.localStorage:es,serialize:JSON.stringify,deserialize:JSON.parse});function Pl({storage:e,key:t=Ol,serialize:n,deserialize:r}){return{...e,getItem:(i,s=null)=>{let o=`${t}.${i.replace(`${t}.`,"")}`,a=e.getItem(o);if(!r)return a!=null?a:s;try{return a?r(a):s}catch(c){return console.warn(c),s}},setItem:(i,s)=>{let o=`${t}.${i.replace(`${t}.`,"")}`;if(s===null)e.removeItem(o);else try{let a=n?n(s):s;e.setItem(o,a)}catch(a){console.error(a)}},removeItem:i=>e.removeItem(`${t}.${i}`)}}function ns(e){return`[@micro-stacks/client] ${e}`}function oe(e,t){jc(e,ns(t))}var rs=(e=>(e.ContractCall="contract_call",e.TokenTransfer="token_transfer",e.ContractDeploy="contract_deploy",e))(rs||{}),ar=(e=>(e.Authentication="status/Authentication",e.TransactionSigning="status/TransactionSigning",e.MessageSigning="status/MessageSigning",e.StructuredMessageSigning="status/StructuredMessageSigning",e))(ar||{}),cr=(e=>(e.IsLoading="status/IsLoading",e.IsIdle="status/IsIdle",e))(cr||{}),Lr="store",is=typeof document>"u",Rl=function(e){var t=e.match(/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/);return t};function Pn(e){if(!!e&&!/[^a-z0-9\:\/\?\#\[\]\@\!\$\&\'\(\)\*\+\,\;\=\.\-\_\~\%]/i.test(e)&&!/%[^0-9a-f]/i.test(e)&&!/%[0-9a-f](:?[^0-9a-f]|$)/i.test(e)){var t=[],n="",r="",i="",s="",o="",a="";if(t=Rl(e),n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],!!(n&&n.length&&i.length>=0)){if(r&&r.length){if(!(i.length===0||/^\//.test(i)))return}else if(/^\/\//.test(i))return;if(/^[a-z][a-z0-9\+\-\.]*$/.test(n.toLowerCase()))return a+=n+":",r&&r.length&&(a+="//"+r),a+=i,s&&s.length&&(a+="?"+s),o&&o.length&&(a+="#"+o),a}}}var Dl="(?<domain>([^?#]*)) wants you to sign in with your Stacks account:",Hl="\\n(?<address>S[A-Z0-9]{40})\\n\\n",Kl="((?<statement>[^\\n]+)\\n)?",ss="(([^:?#]+):)?(([^?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?",Ll=`\\nURI: (?<uri>${ss}?)`,Fl="\\nVersion: (?<version>1)",Ml="\\nChain ID: (?<chainId>[0-9]+)",zl="\\nNonce: (?<nonce>[a-zA-Z0-9]{8,})",lr="([0-9]+)-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])[Tt]([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(.[0-9]+)?(([Zz])|([+|-]([01][0-9]|2[0-3]):[0-5][0-9]))",Vl=`\\nIssued At: (?<issuedAt>${lr})`,jl=`(\\nExpiration Time: (?<expirationTime>${lr}))?`,ql=`(\\nNot Before: (?<notBefore>${lr}))?`,Wl="(\\nRequest ID: (?<requestId>[-._~!$&'()*+,;=:@%a-zA-Z0-9]*))?",Gl=`(\\nResources:(?<resources>(\\n- ${ss}?)+))?`,Zl=`^${Dl}${Hl}${Kl}${Ll}${Fl}${Ml}${zl}${Vl}${jl}${ql}${Wl}${Gl}$`,Jl=class{constructor(e){w(this,"domain");w(this,"address");w(this,"statement");w(this,"uri");w(this,"version");w(this,"chainId");w(this,"nonce");w(this,"issuedAt");w(this,"expirationTime");w(this,"notBefore");w(this,"requestId");w(this,"resources");w(this,"match");var t,n,r,i,s,o,a,c,l,u,f,p,d,y;let h=new RegExp(Zl,"g").exec(e);if(!h)throw new Error("Message did not match the regular expression.");if(this.match=h,this.domain=(t=h==null?void 0:h.groups)==null?void 0:t.domain,this.domain.length===0||!/[^#?]*/.test(this.domain))throw new Error("Domain cannot be empty.");if(this.address=(n=h==null?void 0:h.groups)==null?void 0:n.address,!xi(this.address))throw new Error("Invalid address.");if(this.statement=(r=h==null?void 0:h.groups)==null?void 0:r.statement,this.uri=(i=h==null?void 0:h.groups)==null?void 0:i.uri,!Pn(this.uri))throw new Error("Invalid URI.");this.version=(s=h==null?void 0:h.groups)==null?void 0:s.version,this.nonce=(o=h==null?void 0:h.groups)==null?void 0:o.nonce,this.chainId=parseInt((a=h==null?void 0:h.groups)==null?void 0:a.chainId),this.issuedAt=(c=h==null?void 0:h.groups)==null?void 0:c.issuedAt,this.expirationTime=(l=h==null?void 0:h.groups)==null?void 0:l.expirationTime,this.notBefore=(u=h==null?void 0:h.groups)==null?void 0:u.notBefore,this.requestId=(f=h==null?void 0:h.groups)==null?void 0:f.requestId,this.resources=(d=(p=h==null?void 0:h.groups)==null?void 0:p.resources)==null?void 0:d.split(`
- `).slice(1),((y=this.resources)==null?void 0:y.length)>0&&this.resources.forEach(m=>{if(!Pn(m))throw new Error(`${m} is not a valid resource.`)})}},Xl=["signature","domain","nonce","time"],ye=class{constructor(e,t,n){w(this,"type");w(this,"expected");w(this,"received");this.type=e,this.expected=t,this.received=n}},Ql=class{constructor(e){w(this,"domain");w(this,"address");w(this,"statement");w(this,"uri");w(this,"version");w(this,"chainId");w(this,"nonce");w(this,"issuedAt");w(this,"expirationTime");w(this,"notBefore");w(this,"requestId");w(this,"resources");typeof e=="string"&&(e=new Jl(e)),this.domain=e.domain,this.address=e.address,this.statement=e.statement,this.uri=e.uri,this.version=e.version,this.nonce=e.nonce,this.issuedAt=e.issuedAt,this.expirationTime=e.expirationTime,this.notBefore=e.notBefore,this.requestId=e.requestId,this.chainId=e.chainId,this.resources=e.resources,typeof this.chainId=="string"&&(this.chainId=parseInt(this.chainId)),this.validateMessage()}toMessage(){this.validateMessage();let e=`${this.domain} wants you to sign in with your Stacks account:`,t=`URI: ${this.uri}`,n=[e,this.address].join(`
`),r=`Version: ${this.version}`,i="Chain ID: "+this.chainId||"1",s=`Nonce: ${this.nonce}`,o=[t,r,i,s];if(this.issuedAt&&Date.parse(this.issuedAt),this.issuedAt=this.issuedAt?this.issuedAt:new Date().toISOString(),o.push(`Issued At: ${this.issuedAt}`),this.expirationTime){let c=`Expiration Time: ${this.expirationTime}`;o.push(c)}this.notBefore&&o.push(`Not Before: ${this.notBefore}`),this.requestId&&o.push(`Request ID: ${this.requestId}`),this.resources&&o.push(["Resources:",...this.resources.map(c=>`- ${c}`)].join(`
`));let a=o.join(`
`);return n=[n,this.statement].join(`

`),this.statement&&(n+=`
`),[n,a].join(`
`)}prepareMessage(){let e;switch(this.version){case"1":{e=this.toMessage();break}default:{e=this.toMessage();break}}return e}async verify(e){return new Promise(async(t,n)=>{Object.keys(e).forEach(f=>{Xl.includes(f)||n({success:!1,data:this,error:new Error(`${f} is not a valid key for VerifyParams.`)})});let r=f=>{n(f)},{signature:i,domain:s,nonce:o,time:a}=e;s&&s!==this.domain&&r({success:!1,data:this,error:new ye("Domain do not match provided domain for verification.",s,this.domain)}),o&&o!==this.nonce&&r({success:!1,data:this,error:new ye("Nonce do not match provided nonce for verification.",o,this.nonce)});let c=new Date(a||new Date);if(this.expirationTime){let f=new Date(this.expirationTime);c.getTime()>=f.getTime()&&r({success:!1,data:this,error:new ye("Expired message.",`${c.toISOString()} < ${f.toISOString()}`,`${c.toISOString()} >= ${f.toISOString()}`)})}if(this.notBefore){let f=new Date(this.notBefore);c.getTime()<f.getTime()&&r({success:!1,data:this,error:new ye("Message is not valid yet.",`${c.toISOString()} >= ${f.toISOString()}`,`${c.toISOString()} < ${f.toISOString()}`)})}let l;try{l=this.prepareMessage()}catch(f){r({success:!1,data:this,error:f});return}let u;try{let f=Fi(l),p=zi({signature:i}),d=Mi({hash:f,signature:p.signature,recoveryBytes:p.recoveryBytes});Hc({signature:i,message:f})&&(u=Qn(d,st(this.address)[0]))}catch{}finally{u!==this.address&&r({success:!1,data:this,error:new ye("Signature do not match address of the message.",u,`Resolved address to be ${this.address}`)})}t({success:!0,data:this})})}validateMessage(...e){var t;if(e.length>0)throw new ye("Unable to parse the message.","Unexpected argument in the validateMessage function.");if(!this.domain||this.domain.length===0||!/[^#?]*/.test(this.domain))throw new ye("Invalid domain.",`${this.domain} to be a valid domain.`);if(!xi(this.address))throw new ye("Invalid address.",`${this.address} to be a valid address.`);if(!Pn(this.uri))throw new ye("URI does not conform to RFC 3986.",`${this.uri} to be a valid uri.`);if(this.version!=="1")throw new ye("Invalid message version.","1",this.version);let n=(t=this==null?void 0:this.nonce)==null?void 0:t.match(/[a-zA-Z0-9]{8,}/);if(!n||this.nonce.length<8||n[0]!==this.nonce)throw new ye("Nonce size smaller then 8 characters or is not alphanumeric.",`Length > 8 (${n==null?void 0:n.length}). Alphanumeric.`,this.nonce);let r=/([0-9]+)-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])[Tt]([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\.[0-9]+)?(([Zz])|([+|\-]([01][0-9]|2[0-3]):[0-5][0-9]))/;if(this.issuedAt&&!r.test(this.issuedAt))throw new Error("Invalid time format.");if(this.expirationTime&&!r.test(this.expirationTime))throw new Error("Invalid time format.");if(this.notBefore&&!r.test(this.notBefore))throw new Error("Invalid time format.")}},pt=1;function Fr({state:e,version:t}){var n,r,i;return JSON.stringify([[(n=e.network)==null?void 0:n.chainId,(i=(r=e.network)==null?void 0:r.getCoreApiUrl)==null?void 0:i.call(r)],[e.currentAccountIndex,e.accounts.map(s=>({appPrivateKey:s.appPrivateKey,address:Lt(s.address[0],ae(s.address[1])),profile_url:s.profile_url}))],t])}function Yl(e){var a;let t=JSON.parse(e),[n,r]=t[0],[i,s]=t[1],o=(a=t[2])!=null?a:pt;return{network:n===Le.Mainnet?new We({url:r}):new Yt({url:r}),currentAccountIndex:i,accounts:s.map(c=>{let[l,u]=st(c.address);return{appPrivateKey:c.appPrivateKey,address:[l,W(u)],profile_url:c.profile_url}}),version:o}}var os=e=>{if(e){if(typeof e!="string")return e;if(e==="testnet")return new Yt}return new We},Rn=({network:e=new We,...t})=>({statuses:{["status/Authentication"]:"status/IsIdle",["status/TransactionSigning"]:"status/IsIdle",["status/MessageSigning"]:"status/IsIdle",["status/StructuredMessageSigning"]:"status/IsIdle"},network:os(e),appName:t.appName,appIconUrl:t.appIconUrl,accounts:[],currentAccountIndex:0,onPersistState:t.onPersistState,onAuthentication:t.onAuthentication,onNoWalletFound:t.onNoWalletFound,onSignOut:t.onSignOut}),mn=(e,t)=>{try{let{version:n,...r}=Yl(e);return{state:{...Rn(t),...r},version:n}}catch{return{state:Rn(t),version:pt}}},eu=()=>{if(!je("localStorage",{throwIfUnavailable:!1}))return;let e=localStorage.getItem("MICRO_STACKS_DEBUG");if(e)return JSON.parse(e)},tu=class{constructor(e={}){w(this,"config");w(this,"storage");w(this,"store");w(this,"debug");w(this,"fetcher");w(this,"getState",()=>this.store.getState());w(this,"onStorageUpdate",e=>{if(typeof document<"u"){let t=window.location.host,n=new URL(e.url).host,r=t===n,i=e.key==="micro-stacks.store";if(r&&i){let s=e.newValue;this.hydrate(JSON.parse(s))}}});w(this,"tabSyncSubscription",e=>{let t=typeof document<"u";return t&&e&&window.addEventListener("storage",this.onStorageUpdate),()=>{t&&e&&window.removeEventListener("storage",this.onStorageUpdate)}});w(this,"onPersistState",e=>{var t,n;return(n=(t=this.store.getState())==null?void 0:t.onPersistState)==null?void 0:n.call(t,e)});w(this,"setOnPersistState",e=>{this.setState(t=>({...t,onPersistState:e})),this.config.onPersistState=e});w(this,"setOnNoWalletFound",e=>{this.setState(t=>({...t,onNoWalletFound:e})),this.config.onPersistState=e});w(this,"setOnSignOut",e=>{this.setState(t=>({...t,onSignOut:e})),this.config.onSignOut=e});w(this,"setOnAuthentication",e=>{this.setState(t=>({...t,onAuthentication:e})),this.config.onAuthentication=e});w(this,"persist",async()=>{if(this.onPersistState){let e=this.dehydrate(this.store.getState());await this.onPersistState(e)}});w(this,"selectHasSession",e=>Boolean(e.accounts.length));w(this,"selectAccounts",e=>e.accounts);w(this,"selectAccount",e=>this.selectHasSession(e)?e.accounts[e.currentAccountIndex]:void 0);w(this,"selectNetwork",e=>this.config.enableNetworkSwitching?e.network:os(this.config.network));w(this,"selectNetworkChain",e=>this.selectNetwork(e).chainId===Le.Mainnet?"mainnet":"testnet");w(this,"selectTestnetStxAddress",e=>{let t=this.selectAccount(e);return t?Lt(t.address[0]===Rt.mainnetP2SH?Rt.testnetP2SH:Rt.testnetP2PKH,ae(t.address[1])):void 0});w(this,"selectMainnetStxAddress",e=>{let t=this.selectAccount(e);return t?Lt(t.address[0],ae(t.address[1])):void 0});w(this,"selectStxAddress",e=>this.selectNetworkChain(e)==="mainnet"?this.selectMainnetStxAddress(e):this.selectTestnetStxAddress(e));w(this,"selectAppDetails",e=>e.appName&&e.appIconUrl?{name:e.appName,icon:e.appIconUrl}:void 0);w(this,"selectIdentityAddress",e=>{let t=this.selectAccount(e);return t!=null&&t.appPrivateKey?Ei(t.appPrivateKey):void 0});w(this,"selectDecentralizedID",e=>{let t=this.selectIdentityAddress(e);return t?`did:btc-addr:${t}`:void 0});w(this,"selectStatuses",e=>e.statuses);w(this,"statuses",()=>this.selectStatuses(this.getState()));w(this,"isSignMessageRequestPending",()=>this.statuses()["status/MessageSigning"]);w(this,"isSignStructuredMessageRequestPending",()=>this.statuses()["status/StructuredMessageSigning"]);w(this,"authenticate",async e=>{if(!this.handleNoStacksProviderFound())return;let t=this.selectAppDetails(this.getState());oe(t,"App details are not defined for you app. Most functionality (authentication, signing requests) require details be passed to the wallet. Add them to your MicroStacksClient config.");let n=this.selectAccounts(this.getState());this.setIsRequestPending("status/Authentication"),await mc({appDetails:t,onFinish:async({profile:r,...i})=>{var s,o;let[a,c]=st(i.addresses.mainnet),l=[a,W(c)];n.find(u=>u.address===l)?this.setState(u=>({...u,currentAccountIndex:n.findIndex(f=>f.address===l)})):this.setState(u=>{var f;return{...u,accounts:u.accounts.concat({address:l,appPrivateKey:(f=this.debug)!=null&&f.disableAppPrivateKey?void 0:i.appPrivateKey,decentralizedID:i.decentralizedID,profile_url:i.profile_url}),currentAccountIndex:u.accounts.length}}),(s=e==null?void 0:e.onFinish)==null||s.call(e,i),(o=this.onAuthentication)==null||o.call(this,{profile:r,...i}),await this.persist(),this.setIsIdle("status/Authentication")},onCancel:r=>{var i;this.setIsIdle("status/Authentication"),(i=e==null?void 0:e.onCancel)==null||i.call(e,r)}},es)});w(this,"signOut",async e=>{var t,n,r,i;return(r=(n=(t=this.store)==null?void 0:t.persist)==null?void 0:n.clearStorage)==null||r.call(n),(i=this.onSignOut)==null||i.call(this),this.resetState(),e==null?void 0:e()});w(this,"getSignInMessage",({domain:e,nonce:t,version:n="1.0.0"})=>{if(!this.handleNoStacksProviderFound())return;let r=this.getState(),i=this.selectAppDetails(r),s=this.selectStxAddress(r);oe(i,"App details are not defined for you app. Most functionality (authentication, signing requests) require details be passed to the wallet. Add them to your MicroStacksClient config."),oe(s,"No current Stacks address can be found. This could be because a session has been invalidated, or the user is not signed in.");let o=je("document",{throwIfUnavailable:!1})?window.location.origin:"";return new Ql({domain:i.name,address:s,statement:"Sign in with Stacks",uri:e!=null?e:o,version:n,chainId:Le.Mainnet,nonce:t})});w(this,"signTransaction",async(e,t)=>{if(!this.handleNoStacksProviderFound())return;let n=this.getState(),r=this.selectAppDetails(n),i=this.selectStxAddress(n),s=this.selectAccount(n),o=this.selectNetwork(n);oe(r,"App details are not defined for you app. Most functionality (authentication, signing requests) require details be passed to the wallet. Add them to your MicroStacksClient config."),oe(i,"No current Stacks address can be found. This could be because a session has been invalidated, or the user is not signed in."),oe(s,"There is not current user session available. Please make sure the user has signed in before attempting this action."),this.setIsRequestPending("status/TransactionSigning");let a,c={privateKey:s.appPrivateKey,appDetails:r,stxAddress:i,network:o,postConditionMode:t.postConditionMode,postConditions:t.postConditions,attachment:t.attachment,sponsored:t.sponsored},l=await(e==="token_transfer"?pc:e==="contract_call"?hc:dc)({...c,...t});return oe(l,"Transaction JWT could not be created"),await Ec({token:l,onFinish:u=>{var f;a=u,(f=t==null?void 0:t.onFinish)==null||f.call(t,u),this.setIsIdle("status/TransactionSigning")},onCancel:u=>{var f;(f=t==null?void 0:t.onCancel)==null||f.call(t,u),this.setIsIdle("status/TransactionSigning")}}),a});w(this,"signMessage",async e=>{if(!this.handleNoStacksProviderFound())return;let t=this.getState(),n=this.selectAppDetails(t),r=this.selectStxAddress(t),i=this.selectAccount(t),s=this.selectNetwork(t);oe(n,"App details are not defined for you app. Most functionality (authentication, signing requests) require details be passed to the wallet. Add them to your MicroStacksClient config."),oe(r,"No current Stacks address can be found. This could be because a session has been invalidated, or the user is not signed in."),oe(i,"There is not current user session available. Please make sure the user has signed in before attempting this action."),oe(e.message,"No message found -- a message is required when requesting a message signature."),this.setIsRequestPending("status/MessageSigning");let o;return await kc({appDetails:n,privateKey:i.appPrivateKey,stxAddress:r,network:s,message:e.message,onFinish:a=>{var c;o=a,(c=e==null?void 0:e.onFinish)==null||c.call(e,a),this.setIsIdle("status/MessageSigning")},onCancel:a=>{var c;(c=e==null?void 0:e.onCancel)==null||c.call(e,a),this.setIsIdle("status/MessageSigning")}}),o});w(this,"signStructuredMessage",async e=>{var u,f,p;var t,n,r;if(!this.handleNoStacksProviderFound())return;let i=this.getState(),s=this.selectAppDetails(i),o=this.selectStxAddress(i),a=this.selectAccount(i),c=this.selectNetwork(i);oe(s,"App details are not defined for you app. Most functionality (authentication, signing requests) require details be passed to the wallet. Add them to your MicroStacksClient config."),oe(o,"No current Stacks address can be found. This could be because a session has been invalidated, or the user is not signed in."),oe(a,"There is not current user session available. Please make sure the user has signed in before attempting this action."),oe(e.message,"No message found -- a message is required when requesting a message signature."),this.setIsRequestPending("status/StructuredMessageSigning");let l;return await Nc({appDetails:s,privateKey:a.appPrivateKey,stxAddress:o,network:c,domain:{name:(u=(t=e.domain)==null?void 0:t.name)!=null?u:s.name,version:(f=(n=e.domain)==null?void 0:n.version)!=null?f:"1.0.0",chainId:(p=(r=e.domain)==null?void 0:r.chainId)!=null?p:c.chainId},message:e.message,onFinish:d=>{var y;l=d,(y=e==null?void 0:e.onFinish)==null||y.call(e,d),this.setIsIdle("status/StructuredMessageSigning")},onCancel:d=>{var y;(y=e==null?void 0:e.onCancel)==null||y.call(e,d),this.setIsIdle("status/StructuredMessageSigning")}}),l});w(this,"setNetwork",e=>{if(!this.config.enableNetworkSwitching)throw new Error(ns("Network switching is currently disabled. Set `enableNetworkSwitching` to `true` to enable."));typeof e=="string"?this.setState(t=>({...t,network:e==="mainnet"?new We:new Yt})):this.setState(t=>({...t,network:e})),this.persist()});w(this,"putFile",(e,t,{encrypt:n=!0,sign:r})=>{let i=this.selectHasSession(this.getState()),s=this.selectGaiaHubConfig(this.getState()),o=this.selectAccount(this.getState());if(!i){console.warn("There is not current user session available. Please make sure the user has signed in before attempting this action.");return}if(!(o!=null&&o.appPrivateKey)||!s){console.warn("The current user session has no `appPrivateKey` defined. Certain actions require an `appPrivateKey`, such as using gaia or encryption.");return}return xl(e,t,{privateKey:o.appPrivateKey,gaiaHubConfig:s,encrypt:n,sign:r,wasString:typeof t=="string"})});w(this,"getFile",(e,{decrypt:t=!0,verify:n})=>{let r=this.selectHasSession(this.getState()),i=this.selectGaiaHubConfig(this.getState()),s=this.selectAccount(this.getState());if(!r){console.warn("There is not current user session available. Please make sure the user has signed in before attempting this action.");return}if(!(s!=null&&s.appPrivateKey)||!i){console.warn("The current user session has no `appPrivateKey` defined. Certain actions require an `appPrivateKey`, such as using gaia or encryption.");return}return Ul(e,{privateKey:s.appPrivateKey,gaiaHubConfig:i,decrypt:t,verify:n})});var i,s;let t={storage:(i=e==null?void 0:e.storage)!=null?i:ts,network:(s=e==null?void 0:e.network)!=null?s:new We,...e},n=typeof t.dehydratedState=="function"?t.dehydratedState(this.storeKey):t.dehydratedState,r=n?mn(n,t):{state:Rn(t),version:pt};this.store=Kc(Fc(zc(()=>r.state,{name:Lr,getStorage:()=>t.storage,version:r.version,serialize:({state:o,version:a})=>Fr({state:o,version:a!=null?a:pt}),deserialize:o=>mn(o,t)}))),this.debug=eu(),this.config=t,this.storage=t.storage,this.fetcher=t.fetcher||Ge}setState(e){let t=typeof e=="function"?e(this.store.getState()):e;this.store.setState(t,!0)}resetState(){this.setState(e=>({...e,accounts:[],currentAccountIndex:0}))}get subscribe(){return this.store.subscribe}getStacksProvider(){return je("StacksProvider",{throwIfUnavailable:!1})}subscribeToStacksProvider(e,t=100){if(this.getStacksProvider())return e(),()=>{};{let n=setInterval(()=>{this.getStacksProvider()&&(e(),clearInterval(n))},t);return()=>{typeof n<"u"&&clearInterval(n)}}}get storeKey(){return Lr}get onAuthentication(){var e;return(e=this.store.getState())==null?void 0:e.onAuthentication}get onNoWalletFound(){var e;return(e=this.store.getState())==null?void 0:e.onNoWalletFound}get onSignOut(){var e;return(e=this.store.getState())==null?void 0:e.onSignOut}dehydrate(e){return Fr({state:e!=null?e:this.store.getState(),version:pt})}hydrate(e){let t=mn(e,this.config);this.setState(t.state)}setStatus(e,t){this.setState(n=>({...n,statuses:{...n.statuses,[e]:t}}))}setIsRequestPending(e){this.setStatus(e,"status/IsLoading")}setIsIdle(e){this.setStatus(e,"status/IsIdle")}handleNoStacksProviderFound(){return typeof this.getStacksProvider()>"u"?typeof this.onNoWalletFound<"u"?(this.onNoWalletFound(),!1):(oe(this.getStacksProvider(),"The injected `StacksProvider` cannot be found. This is typically because there is no Stacks wallet available, such as the Hiro web wallet extension or the iOS/Android wallet Xverse."),!1):!0}selectGaiaHubConfig(e){let t=this.selectHasSession(e),n=this.selectAccount(e);if(!(!t||!(n!=null&&n.appPrivateKey)))return pl({gaiaHubUrl:"https://hub.blockstack.org",privateKey:n.appPrivateKey})}async fetchBNSName(){var e;let t=this.selectStxAddress(this.getState()),n=this.selectNetwork(this.getState());if(!t){console.warn("No Stacks address found while trying to fetch BNS name");return}let r=n.getCoreApiUrl()+`/v1/addresses/stacks/${t}`;try{let i=await(await this.fetcher(r)).json();return(e=i==null?void 0:i.names)==null?void 0:e[0]}catch(i){console.log("[@micro-stacks/client] fetchBNSName failed",i)}}async fetchZoneFile(){try{let e=this.selectStxAddress(this.getState()),t=this.selectNetwork(this.getState());if(!e){console.warn("No Stacks address found while trying to fetch zonefile name");return}let n=t.getCoreApiUrl()+`/v1/names/${e}/zonefile`;return await(await this.fetcher(n)).json()}catch(e){console.log("[@micro-stacks/client] fetchZoneFile failed",e)}}async fetchProfile(){let e=this.selectAccount(this.getState());if(e!=null&&e.profile_url)try{return await(await this.fetcher(e.profile_url)).json()}catch(t){console.log("[@micro-stacks/client] fetchProfile failed",t)}}encrypt(e,t={}){var r;var n;if((t==null?void 0:t.publicKey)&&(t==null?void 0:t.privateKey))throw Error("Error: do not pass both `publicKey` and `privateKey` to client.encrypt");return $i(e,{...t,privateKey:(r=t.privateKey)!=null?r:(n=this.selectAccount(this.getState()))==null?void 0:n.appPrivateKey})}decrypt(e,t){var i;var n;let r=(i=t.privateKey)!=null?i:(n=this.selectAccount(this.getState()))==null?void 0:n.appPrivateKey;if(!r)throw Error("You must pass a `privateKey` value to client.decrypt");return Yn(e,{privateKey:r})}},gt;function Dn(e){var n;let t=(n=e==null?void 0:e.client)!=null?n:new tu(e==null?void 0:e.config);return is?t:(gt=t,gt)}function ct(e){return is?Dn(e):gt!=null?gt:Dn(e)}var nu=({client:e,state:t})=>e.selectAccount(t||e.getState()),ru=({client:e,state:t})=>e.selectStxAddress(t||e.getState()),iu=({client:e,state:t})=>e.selectIdentityAddress(t||e.getState()),su=({client:e,state:t})=>e.selectDecentralizedID(t||e.getState()),ou=({client:e,state:t})=>e.selectNetwork(t||e.getState()),au=({client:e,state:t})=>e.selectStatuses(t||e.getState()),cu=(e,t=ct())=>t.subscribe(t.selectAccount,e,{equalityFn:at}),lu=(e,t=ct())=>t.subscribe(t.selectStxAddress,e,{equalityFn:at}),uu=(e,t=ct())=>t.subscribe(t.selectIdentityAddress,e,{equalityFn:at}),fu=(e,t=ct())=>t.subscribe(t.selectDecentralizedID,e,{equalityFn:at}),hu=(e,t=ct())=>t.subscribe(t.selectNetwork,e,{equalityFn:at}),du=(e,t=ct())=>t.subscribe(t.selectStatuses,e,{equalityFn:at}),as="micro-stacks-client-context",tf=({appName:e,appIconUrl:t,storage:n=ts,network:r,dehydratedState:i,onPersistState:s,onSignOut:o,onAuthentication:a,onNoWalletFound:c,fetcher:l})=>{ps(as,Dn({config:{appName:e,appIconUrl:t,storage:n,network:r,dehydratedState:i,onPersistState:s,onSignOut:o,onAuthentication:a,onNoWalletFound:c,fetcher:l}}))},pu="No MicroStacksClient set, mount the client in your app by wrapping your app in `ClientProvider` or using `mountClient`",tn=()=>{let e=gs(as);if(!e)throw new Error(pu);return e};function lt(e,t){return()=>{let n=tn();return ws(e({client:n}),r=>t(r,n))}}var gu=lt(ru,lu),yu=lt(nu,cu),wu=lt(iu,uu),mu=lt(ou,hu),cs=lt(au,du),bu=lt(su,fu);function ur(){return Gt([yu(),gu(),wu(),bu()],([e,t,n,r])=>{var i,s,o;return{appPrivateKey:(i=e==null?void 0:e.appPrivateKey)!=null?i:null,rawAddress:(s=e==null?void 0:e.address)!=null?s:null,stxAddress:t,identityAddress:n,decentralizedID:r,profileUrl:(o=e==null?void 0:e.profile_url)!=null?o:null}})}function ls(){let e=tn();return Gt([ur(),cs()],([t,n])=>({openAuthRequest:e.authenticate,signOut:e.signOut,isSignedIn:!!t.stxAddress,isRequestPending:n[ar.Authentication]===cr.IsLoading}))}function nf(){let e=tn(),t=n=>(n.isMainnet=()=>n.chainId===Le.Mainnet,{setNetwork:e.setNetwork,network:n,isMainnet:n.isMainnet()});return Gt([mu()],([n])=>t(n))}function nn(e){let t=tn();return Gt([cs()],([n])=>{let r=s=>t.signTransaction(rs.ContractCall,{...s,onFinish:o=>{var a,c;(a=s==null?void 0:s.onFinish)==null||a.call(s,o),(c=e==null?void 0:e.onFinish)==null||c.call(e,o)},onCancel:o=>{var a,c;(a=s==null?void 0:s.onCancel)==null||a.call(s,o),(c=e==null?void 0:e.onCancel)==null||c.call(e,o)}}),i=n[ar.TransactionSigning]===cr.IsLoading;return{openContractCall:r,isRequestPending:i}})}function vu(e){let t,n,r,i,s,o,a,c,l,u,f,p,d;return{c(){t=E("section"),n=E("div"),r=E("div"),i=E("div"),s=E("div"),o=E("div"),a=E("h1"),c=E("span"),l=K("Transaction"),u=E("br"),f=K("Network Status"),p=j(),d=E("div"),this.h()},l(y){t=A(y,"SECTION",{id:!0});var h=$(t);n=A(h,"DIV",{class:!0,style:!0});var m=$(n);r=A(m,"DIV",{class:!0,style:!0});var S=$(r);i=A(S,"DIV",{class:!0});var v=$(i);s=A(v,"DIV",{class:!0});var _=$(s);o=A(_,"DIV",{class:!0});var T=$(o);a=A(T,"H1",{});var k=$(a);c=A(k,"SPAN",{class:!0});var U=$(c);l=L(U,"Transaction"),U.forEach(b),u=A(k,"BR",{}),f=L(k,"Network Status"),k.forEach(b),T.forEach(b),p=q(_),d=A(_,"DIV",{class:!0});var ee=$(d);ee.forEach(b),_.forEach(b),v.forEach(b),S.forEach(b),m.forEach(b),h.forEach(b),this.h()},h(){x(c,"class","strokeme"),x(o,"class","col-12"),x(d,"class","col-sm-6 col-xs-12 p-4"),x(s,"class","row"),x(i,"class","m-5"),x(r,"class","col-md-11 col-sm-12"),et(r,"height","100%"),x(n,"class","row"),et(n,"height","100%"),et(n,"width","100%"),x(t,"id","section3")},m(y,h){se(y,t,h),g(t,n),g(n,r),g(r,i),g(i,s),g(s,o),g(o,a),g(a,c),g(c,l),g(a,u),g(a,f),g(s,p),g(s,d)},p:ce,i:ce,o:ce,d(y){y&&b(t)}}}function Su(e,t,n){const r=nn();return Ve(e,r,i=>n(1,i)),[r]}class xu extends xt{constructor(t){super(),Et(this,t,Su,vu,At,{})}}function Eu(e){let t,n,r,i;return{c(){t=E("button"),n=K("Send"),this.h()},l(s){t=A(s,"BUTTON",{class:!0});var o=$(t);n=L(o,"Send"),o.forEach(b),this.h()},h(){x(t,"class","btn btn-info text-white")},m(s,o){se(s,t,o),g(t,n),r||(i=ge(t,"click",e[9]),r=!0)},p:ce,d(s){s&&b(t),r=!1,i()}}}function Mr(e){let t,n;return{c(){t=E("div"),n=K(e[1]),this.h()},l(r){t=A(r,"DIV",{class:!0});var i=$(t);n=L(i,e[1]),i.forEach(b),this.h()},h(){x(t,"class","text-warning")},m(r,i){se(r,t,i),g(t,n)},p(r,i){i&2&&Ke(n,r[1])},d(r){r&&b(t)}}}function Au(e){let t,n,r,i,s,o,a,c,l,u,f,p,d,y,h,m,S,v,_,T,k,U,ee;function R(N,P){return Eu}let G=R()(e),O=e[1]&&Mr(e);return{c(){t=E("section"),n=E("h3"),r=K(e[0]),i=j(),s=E("div"),o=E("div"),a=E("div"),c=E("label"),l=K("Number of Blocks to Mine"),u=j(),f=E("input"),p=j(),d=E("div"),y=E("div"),h=E("label"),m=K("uSTX Per Block"),S=j(),v=E("input"),_=j(),T=E("div"),G.c(),k=j(),O&&O.c(),this.h()},l(N){t=A(N,"SECTION",{});var P=$(t);n=A(P,"H3",{});var V=$(n);r=L(V,e[0]),V.forEach(b),i=q(P),s=A(P,"DIV",{});var D=$(s);o=A(D,"DIV",{class:!0});var Y=$(o);a=A(Y,"DIV",{class:!0});var H=$(a);c=A(H,"LABEL",{for:!0});var fe=$(c);l=L(fe,"Number of Blocks to Mine"),fe.forEach(b),u=q(H),f=A(H,"INPUT",{id:!0,class:!0,placeholder:!0,type:!0,"aria-describedby":!0}),H.forEach(b),Y.forEach(b),p=q(D),d=A(D,"DIV",{class:!0});var le=$(d);y=A(le,"DIV",{class:!0});var re=$(y);h=A(re,"LABEL",{for:!0});var Ie=$(h);m=L(Ie,"uSTX Per Block"),Ie.forEach(b),S=q(re),v=A(re,"INPUT",{id:!0,class:!0,placeholder:!0,type:!0,"aria-describedby":!0}),re.forEach(b),le.forEach(b),_=q(D),T=A(D,"DIV",{});var ve=$(T);G.l(ve),ve.forEach(b),k=q(D),O&&O.l(D),D.forEach(b),P.forEach(b),this.h()},h(){x(c,"for","numberBlocks"),x(f,"id","numberBlocks"),x(f,"class","w-100 form-control"),x(f,"placeholder","Number of blocks to mine"),x(f,"type","string"),x(f,"aria-describedby","Contribution"),x(a,"class",""),x(o,"class","mb-3"),x(h,"for","stxPerBlock"),x(v,"id","stxPerBlock"),x(v,"class","w-100 form-control"),x(v,"placeholder","STX to commit per block"),x(v,"type","string"),x(v,"aria-describedby","Contribution"),x(y,"class",""),x(d,"class","mb-3")},m(N,P){se(N,t,P),g(t,n),g(n,r),g(t,i),g(t,s),g(s,o),g(o,a),g(a,c),g(c,l),g(a,u),g(a,f),xe(f,e[2]),g(s,p),g(s,d),g(d,y),g(y,h),g(h,m),g(y,S),g(y,v),xe(v,e[3]),g(s,_),g(s,T),G.m(T,null),g(s,k),O&&O.m(s,null),U||(ee=[ge(f,"input",e[7]),ge(v,"input",e[8])],U=!0)},p(N,[P]){P&1&&Ke(r,N[0]),P&4&&xe(f,N[2]),P&8&&xe(v,N[3]),G.p(N,P),N[1]?O?O.p(N,P):(O=Mr(N),O.c(),O.m(s,null)):O&&(O.d(1),O=null)},i:ce,o:ce,d(N){N&&b(t),G.d(),O&&O.d(),U=!1,Kn(ee)}}}function _u(e,t,n){let r,i,s,o;const a=nn();Ve(e,a,h=>n(11,o=h));let{transType:c}=t,l;const u=ur();Ve(e,u,h=>n(10,s=h));const f=async()=>{if(!r||r===0){n(1,l="Number of blocks to mine for and amount of stx to commit to each block are both required.");return}if(!i||i===0){n(1,l="Number of blocks to mine for and amount of stx to commit to each block are both required.");return}n(1,l=void 0);const h="STSCWDV3RKV5ZRN1FQD84YE1NQFEDJ9R1D64KKHQ.newyorkcitycoin-core-v2".split(".")[0],m="STSCWDV3RKV5ZRN1FQD84YE1NQFEDJ9R1D64KKHQ.newyorkcitycoin-core-v2".split(".")[1];let S=[];for(let _=0;_<r;_++)S.push(nr(i));let v=$a(S);await o.openContractCall({postConditions:[Di(s.stxAddress,rr.Equal,i*r)],postConditionMode:en.Deny,contractAddress:h,contractName:m,functionName:c,functionArgs:[v],onFinish:_=>{console.log(_)},onCancel:()=>{console.log("popup closed!")}})};function p(){r=this.value,n(2,r)}function d(){i=this.value,n(3,i)}const y=()=>f();return e.$$set=h=>{"transType"in h&&n(0,c=h.transType)},n(2,r=void 0),n(3,i=void 0),[c,l,r,i,a,u,f,p,d,y]}class $u extends xt{constructor(t){super(),Et(this,t,_u,Au,At,{transType:0})}}function Iu(e){let t,n,r,i;return{c(){t=E("button"),n=K("Send"),this.h()},l(s){t=A(s,"BUTTON",{class:!0});var o=$(t);n=L(o,"Send"),o.forEach(b),this.h()},h(){x(t,"class","btn btn-info text-white")},m(s,o){se(s,t,o),g(t,n),r||(i=ge(t,"click",e[10]),r=!0)},p:ce,d(s){s&&b(t),r=!1,i()}}}function zr(e){let t,n;return{c(){t=E("div"),n=K(e[1]),this.h()},l(r){t=A(r,"DIV",{class:!0});var i=$(t);n=L(i,e[1]),i.forEach(b),this.h()},h(){x(t,"class","text-warning")},m(r,i){se(r,t,i),g(t,n)},p(r,i){i&2&&Ke(n,r[1])},d(r){r&&b(t)}}}function ku(e){let t,n,r,i,s,o=e[4].stxAddress+"",a,c,l,u,f,p,d,y,h,m,S,v,_,T,k,U,ee,R,Z,G,O;function N(Y,H){return Iu}let V=N()(e),D=e[1]&&zr(e);return{c(){t=E("section"),n=E("h3"),r=K(e[0]),i=j(),s=E("p"),a=K(o),c=j(),l=E("div"),u=E("div"),f=E("div"),p=E("label"),d=K("Memo (optional)"),y=j(),h=E("input"),m=j(),S=E("div"),v=E("div"),_=E("label"),T=K("Amount uSTX"),k=j(),U=E("input"),ee=j(),R=E("div"),V.c(),Z=j(),D&&D.c(),this.h()},l(Y){t=A(Y,"SECTION",{});var H=$(t);n=A(H,"H3",{});var fe=$(n);r=L(fe,e[0]),fe.forEach(b),i=q(H),s=A(H,"P",{});var le=$(s);a=L(le,o),le.forEach(b),c=q(H),l=A(H,"DIV",{});var re=$(l);u=A(re,"DIV",{class:!0});var Ie=$(u);f=A(Ie,"DIV",{class:!0});var ve=$(f);p=A(ve,"LABEL",{for:!0});var ie=$(p);d=L(ie,"Memo (optional)"),ie.forEach(b),y=q(ve),h=A(ve,"INPUT",{id:!0,class:!0,placeholder:!0,type:!0,"aria-describedby":!0}),ve.forEach(b),Ie.forEach(b),m=q(re),S=A(re,"DIV",{class:!0});var te=$(S);v=A(te,"DIV",{class:!0});var B=$(v);_=A(B,"LABEL",{for:!0});var J=$(_);T=L(J,"Amount uSTX"),J.forEach(b),k=q(B),U=A(B,"INPUT",{id:!0,class:!0,placeholder:!0,type:!0,"aria-describedby":!0}),B.forEach(b),te.forEach(b),ee=q(re),R=A(re,"DIV",{});var ut=$(R);V.l(ut),ut.forEach(b),Z=q(re),D&&D.l(re),re.forEach(b),H.forEach(b),this.h()},h(){x(p,"for","memo"),x(h,"id","memo"),x(h,"class","w-100 form-control"),x(h,"placeholder","Memo"),x(h,"type","string"),x(h,"aria-describedby","Contribution"),x(f,"class",""),x(u,"class","mb-3"),x(_,"for","stxPerBlock"),x(U,"id","stxPerBlock"),x(U,"class","w-100 form-control"),x(U,"placeholder","STX to commit per block"),x(U,"type","string"),x(U,"aria-describedby","Contribution"),x(v,"class",""),x(S,"class","mb-3")},m(Y,H){se(Y,t,H),g(t,n),g(n,r),g(t,i),g(t,s),g(s,a),g(t,c),g(t,l),g(l,u),g(u,f),g(f,p),g(p,d),g(f,y),g(f,h),xe(h,e[3]),g(l,m),g(l,S),g(S,v),g(v,_),g(_,T),g(v,k),g(v,U),xe(U,e[2]),g(l,ee),g(l,R),V.m(R,null),g(l,Z),D&&D.m(l,null),G||(O=[ge(h,"input",e[8]),ge(U,"input",e[9])],G=!0)},p(Y,[H]){H&1&&Ke(r,Y[0]),H&16&&o!==(o=Y[4].stxAddress+"")&&Ke(a,o),H&8&&xe(h,Y[3]),H&4&&xe(U,Y[2]),V.p(Y,H),Y[1]?D?D.p(Y,H):(D=zr(Y),D.c(),D.m(l,null)):D&&(D.d(1),D=null)},i:ce,o:ce,d(Y){Y&&b(t),V.d(),D&&D.d(),G=!1,Kn(O)}}}function Tu(e,t,n){let r,i,s,o;const a=nn();Ve(e,a,h=>n(11,o=h));let{transType:c}=t,l;ls();const u=ur();Ve(e,u,h=>n(4,s=h));const f=async()=>{if(!r||r===0){n(1,l="Amount of stx to commit is required.");return}n(1,l=void 0);const h="STSCWDV3RKV5ZRN1FQD84YE1NQFEDJ9R1D64KKHQ.newyorkcitycoin-core-v2".split(".")[0],m="STSCWDV3RKV5ZRN1FQD84YE1NQFEDJ9R1D64KKHQ.newyorkcitycoin-core-v2".split(".")[1];let S=Ni();i&&(S=Ui(Ci(i))),await o.openContractCall({postConditions:[Di(s.stxAddress,rr.Equal,r)],postConditionMode:en.Deny,contractAddress:h,contractName:m,functionName:c,functionArgs:[nr(r),S],onFinish:v=>{console.log(v)},onCancel:()=>{console.log("popup closed!")}})};function p(){i=this.value,n(3,i)}function d(){r=this.value,n(2,r)}const y=()=>f();return e.$$set=h=>{"transType"in h&&n(0,c=h.transType)},n(2,r=void 0),n(3,i=void 0),[c,l,r,i,s,a,u,f,p,d,y]}class Cu extends xt{constructor(t){super(),Et(this,t,Tu,ku,At,{transType:0})}}function Nu(e){let t,n,r,i;return{c(){t=E("button"),n=K("Send"),this.h()},l(s){t=A(s,"BUTTON",{class:!0});var o=$(t);n=L(o,"Send"),o.forEach(b),this.h()},h(){x(t,"class","btn btn-info text-white")},m(s,o){se(s,t,o),g(t,n),r||(i=ge(t,"click",e[5]),r=!0)},p:ce,d(s){s&&b(t),r=!1,i()}}}function Uu(e){let t,n,r,i,s,o,a,c,l,u,f,p;function d(m,S){return Nu}let h=d()(e);return{c(){t=E("section"),n=E("h3"),r=K(e[0]),i=j(),s=E("div"),o=E("div"),a=E("div"),c=E("input"),l=j(),u=E("div"),h.c(),this.h()},l(m){t=A(m,"SECTION",{});var S=$(t);n=A(S,"H3",{});var v=$(n);r=L(v,e[0]),v.forEach(b),i=q(S),s=A(S,"DIV",{});var _=$(s);o=A(_,"DIV",{class:!0});var T=$(o);a=A(T,"DIV",{class:!0});var k=$(a);c=A(k,"INPUT",{class:!0,placeholder:!0,type:!0,"aria-describedby":!0}),k.forEach(b),T.forEach(b),l=q(_),u=A(_,"DIV",{});var U=$(u);h.l(U),U.forEach(b),_.forEach(b),S.forEach(b),this.h()},h(){x(c,"class","w-100 form-control"),x(c,"placeholder","memo"),x(c,"type","string"),x(c,"aria-describedby","Contribution"),x(a,"class",""),x(o,"class","mb-3")},m(m,S){se(m,t,S),g(t,n),g(n,r),g(t,i),g(t,s),g(s,o),g(o,a),g(a,c),xe(c,e[1]),g(s,l),g(s,u),h.m(u,null),f||(p=ge(c,"input",e[4]),f=!0)},p(m,[S]){S&1&&Ke(r,m[0]),S&2&&xe(c,m[1]),h.p(m,S)},i:ce,o:ce,d(m){m&&b(t),h.d(),f=!1,p()}}}function Bu(e,t,n){let r,i;const s=nn();Ve(e,s,u=>n(6,i=u));let{transType:o}=t;const a=async()=>{const u="STSCWDV3RKV5ZRN1FQD84YE1NQFEDJ9R1D64KKHQ.newyorkcitycoin-core-v2".split(".")[0],f="STSCWDV3RKV5ZRN1FQD84YE1NQFEDJ9R1D64KKHQ.newyorkcitycoin-core-v2".split(".")[1];let p=Ni();r&&(p=Ui(Ci(r))),await i.openContractCall({postConditions:[],postConditionMode:en.Deny,contractAddress:u,contractName:f,functionName:o,functionArgs:[p],onFinish:d=>{console.log(d)},onCancel:()=>{console.log("popup closed!")}})};function c(){r=this.value,n(1,r)}const l=()=>a();return e.$$set=u=>{"transType"in u&&n(0,o=u.transType)},n(1,r=void 0),[o,r,s,a,c,l]}class Ou extends xt{constructor(t){super(),Et(this,t,Bu,Uu,At,{transType:0})}}var Hn={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});function n(r,i,s){s===void 0&&(s=!1),s&&(i=i/r,r=1);var o=[],a=0,c=0,l,u=function(){var f=a+i,p=Date.now();if(p<f){l!==void 0&&clearTimeout(l),l=setTimeout(u,f-p);return}a=p,c=0;for(var d=0,y=o.splice(0,r);d<y.length;d++){var h=y[d];c++,h()}o.length?l=setTimeout(u,i):l=void 0};return function(f){return new Promise(function(p,d){var y=function(){return Promise.resolve().then(f).then(p).catch(d)},h=Date.now();l===void 0&&h-a>i&&(a=h,c=0),c++<r?y():(o.push(y),l===void 0&&(l=setTimeout(u,a+i-h)))})}}e.exports=n,t.default=n})(Hn,Hn.exports);const Pu=Bl(Hn.exports),Ru=!1,Du=e=>Ru,Hu=Pu(1,1e3,!0),us=async e=>{const t=await Hu(()=>fetch(e));if(t.status===200){const n=await t.json();return Du(`fetchJson: ${JSON.stringify(n)}`),n}throw new Error(`fetchJson: ${e} ${t.status} ${t.statusText}`)},Ku=new We({coreApiUrl:"https://stacks-node-api.mainnet.stacks.co"});new Yt({coreApiUrl:"https://stacks-node-api.testnet.stacks.co"});const fs=Ku;async function Lu(){const e=`${fs.getCoreApiUrl()}/v2/info`;return+(await us(e)).stacks_tip_height}async function Fu(){const e=`${fs.getCoreApiUrl()}/extended/v1/tx/mempool`;return+(await us(e)).total}const Mu="/citycoin-client/internal/immutable/assets/cityscape-1-e40e85a0.jpeg",zu="/citycoin-client/internal/immutable/assets/stx_eco_arrow_down-e17d52f2.png";function Vu(e){let t,n;return{c(){t=E("span"),n=K("Connect Wallet"),this.h()},l(r){t=A(r,"SPAN",{class:!0});var i=$(t);n=L(i,"Connect Wallet"),i.forEach(b),this.h()},h(){x(t,"class","nav-item")},m(r,i){se(r,t,i),g(t,n)},p:ce,i:ce,o:ce,d(r){r&&b(t)}}}function ju(e){let t,n,r,i,s,o,a,c,l,u,f,p,d,y,h,m,S,v,_,T,k,U,ee,R,Z,G,O,N="STSCWDV3RKV5ZRN1FQD84YE1NQFEDJ9R1D64KKHQ.newyorkcitycoin-core-v2".split(".")[1]+"",P,V,D="SP1H1733V5MZ3SZ9XRW9FKYGEZT0JDGEB8Y634C7R.miamicoin-core-v2".split(".")[1]+"",Y,H,fe,le,re,Ie,ve,ie=e[0]&&Vr(e),te=e[2]&&jr(e);return{c(){t=E("div"),n=E("div"),r=K(e[7]),i=j(),s=E("div"),o=K("Mem Pool: "),a=K(e[3]),c=j(),l=E("div"),u=K("Block Height: "),f=K(e[4]),p=j(),d=E("div"),y=j(),h=E("div"),m=E("div"),S=E("select"),v=E("option"),_=K("Select Version"),T=E("option"),k=K("V2"),U=j(),ee=E("div"),R=E("select"),Z=E("option"),G=K("Select City"),O=E("option"),P=K(N),V=E("option"),Y=K(D),H=j(),ie&&ie.c(),fe=j(),te&&te.c(),le=br(),this.h()},l(B){t=A(B,"DIV",{class:!0});var J=$(t);n=A(J,"DIV",{class:!0});var ut=$(n);r=L(ut,e[7]),ut.forEach(b),i=q(J),s=A(J,"DIV",{class:!0});var rn=$(s);o=L(rn,"Mem Pool: "),a=L(rn,e[3]),rn.forEach(b),c=q(J),l=A(J,"DIV",{class:!0});var sn=$(l);u=L(sn,"Block Height: "),f=L(sn,e[4]),sn.forEach(b),p=q(J),d=A(J,"DIV",{class:!0}),$(d).forEach(b),J.forEach(b),y=q(B),h=A(B,"DIV",{class:!0});var Je=$(h);m=A(Je,"DIV",{class:!0});var fr=$(m);S=A(fr,"SELECT",{class:!0,"aria-label":!0});var on=$(S);v=A(on,"OPTION",{});var hr=$(v);_=L(hr,"Select Version"),hr.forEach(b),T=A(on,"OPTION",{});var dr=$(T);k=L(dr,"V2"),dr.forEach(b),on.forEach(b),fr.forEach(b),U=q(Je),ee=A(Je,"DIV",{class:!0});var pr=$(ee);R=A(pr,"SELECT",{class:!0,"aria-label":!0});var kt=$(R);Z=A(kt,"OPTION",{});var gr=$(Z);G=L(gr,"Select City"),gr.forEach(b),O=A(kt,"OPTION",{});var yr=$(O);P=L(yr,N),yr.forEach(b),V=A(kt,"OPTION",{});var wr=$(V);Y=L(wr,D),wr.forEach(b),kt.forEach(b),pr.forEach(b),H=q(Je),ie&&ie.l(Je),Je.forEach(b),fe=q(B),te&&te.l(B),le=br(),this.h()},h(){x(n,"class","col-2"),x(s,"class","col-2"),x(l,"class","col-2"),x(d,"class","col-6"),x(t,"class","row g-1 mb-3 bg-light text-dark py-2 px-2"),v.__value="",v.value=v.__value,T.__value="v2",T.value=T.__value,x(S,"class","form-select"),x(S,"aria-label","Default select example"),e[1]===void 0&&bn(()=>e[9].call(S)),x(m,"class","col-2"),Z.__value="",Z.value=Z.__value,O.__value="nyc",O.value=O.__value,V.__value="mia",V.value=V.__value,x(R,"class","form-select"),x(R,"aria-label","Default select example"),e[0]===void 0&&bn(()=>e[10].call(R)),x(ee,"class","col-2"),x(h,"class","row g-1 mb-3")},m(B,J){se(B,t,J),g(t,n),g(n,r),g(t,i),g(t,s),g(s,o),g(s,a),g(t,c),g(t,l),g(l,u),g(l,f),g(t,p),g(t,d),se(B,y,J),se(B,h,J),g(h,m),g(m,S),g(S,v),g(v,_),g(S,T),g(T,k),Ye(S,e[1]),g(h,U),g(h,ee),g(ee,R),g(R,Z),g(Z,G),g(R,O),g(O,P),g(R,V),g(V,Y),Ye(R,e[0]),g(h,H),ie&&ie.m(h,null),se(B,fe,J),te&&te.m(B,J),se(B,le,J),re=!0,Ie||(ve=[ge(S,"change",e[9]),ge(R,"change",e[10])],Ie=!0)},p(B,J){(!re||J&8)&&Ke(a,B[3]),(!re||J&16)&&Ke(f,B[4]),J&2&&Ye(S,B[1]),J&1&&Ye(R,B[0]),B[0]?ie?ie.p(B,J):(ie=Vr(B),ie.c(),ie.m(h,null)):ie&&(ie.d(1),ie=null),B[2]?te?(te.p(B,J),J&4&&me(te,1)):(te=jr(B),te.c(),me(te,1),te.m(le.parentNode,le)):te&&(Ln(),Ae(te,1,1,()=>{te=null}),Fn())},i(B){re||(me(te),re=!0)},o(B){Ae(te),re=!1},d(B){B&&b(t),B&&b(y),B&&b(h),ie&&ie.d(),B&&b(fe),te&&te.d(B),B&&b(le),Ie=!1,Kn(ve)}}}function Vr(e){let t,n,r,i,s,o,a,c,l,u,f,p;return{c(){t=E("div"),n=E("select"),r=E("option"),i=K("Select Transaction"),s=E("option"),o=K("register-user"),a=E("option"),c=K("mine-tokens"),l=E("option"),u=K("mine-many"),this.h()},l(d){t=A(d,"DIV",{class:!0});var y=$(t);n=A(y,"SELECT",{class:!0,"aria-label":!0});var h=$(n);r=A(h,"OPTION",{});var m=$(r);i=L(m,"Select Transaction"),m.forEach(b),s=A(h,"OPTION",{});var S=$(s);o=L(S,"register-user"),S.forEach(b),a=A(h,"OPTION",{});var v=$(a);c=L(v,"mine-tokens"),v.forEach(b),l=A(h,"OPTION",{});var _=$(l);u=L(_,"mine-many"),_.forEach(b),h.forEach(b),y.forEach(b),this.h()},h(){r.__value="",r.value=r.__value,s.__value="register-user",s.value=s.__value,a.__value="mine-tokens",a.value=a.__value,l.__value="mine-many",l.value=l.__value,x(n,"class","form-select"),x(n,"aria-label","Default select example"),e[2]===void 0&&bn(()=>e[11].call(n)),x(t,"class","col-2")},m(d,y){se(d,t,y),g(t,n),g(n,r),g(r,i),g(n,s),g(s,o),g(n,a),g(a,c),g(n,l),g(l,u),Ye(n,e[2]),f||(p=ge(n,"change",e[11]),f=!0)},p(d,y){y&4&&Ye(n,d[2])},d(d){d&&b(t),f=!1,p()}}}function jr(e){let t,n,r,i,s;const o=[Zu,Gu,Wu,qu],a=[];function c(l,u){return l[2]==="get-network-status"?0:l[2]==="mine-tokens"?1:l[2]==="mine-many"?2:l[2]==="register-user"?3:-1}return~(r=c(e))&&(i=a[r]=o[r](e)),{c(){t=E("div"),n=E("div"),i&&i.c(),this.h()},l(l){t=A(l,"DIV",{class:!0});var u=$(t);n=A(u,"DIV",{class:!0});var f=$(n);i&&i.l(f),f.forEach(b),u.forEach(b),this.h()},h(){x(n,"class","col-12"),x(t,"class","row g-1 my-4 bg-light text-dark py-2 px-2")},m(l,u){se(l,t,u),g(t,n),~r&&a[r].m(n,null),s=!0},p(l,u){let f=r;r=c(l),r===f?~r&&a[r].p(l,u):(i&&(Ln(),Ae(a[f],1,1,()=>{a[f]=null}),Fn()),~r?(i=a[r],i?i.p(l,u):(i=a[r]=o[r](l),i.c()),me(i,1),i.m(n,null)):i=null)},i(l){s||(me(i),s=!0)},o(l){Ae(i),s=!1},d(l){l&&b(t),~r&&a[r].d()}}}function qu(e){let t,n;return t=new Ou({props:{transType:e[2]}}),{c(){Vt(t.$$.fragment)},l(r){jt(t.$$.fragment,r)},m(r,i){qt(t,r,i),n=!0},p(r,i){const s={};i&4&&(s.transType=r[2]),t.$set(s)},i(r){n||(me(t.$$.fragment,r),n=!0)},o(r){Ae(t.$$.fragment,r),n=!1},d(r){Wt(t,r)}}}function Wu(e){let t,n;return t=new $u({props:{transType:e[2]}}),{c(){Vt(t.$$.fragment)},l(r){jt(t.$$.fragment,r)},m(r,i){qt(t,r,i),n=!0},p(r,i){const s={};i&4&&(s.transType=r[2]),t.$set(s)},i(r){n||(me(t.$$.fragment,r),n=!0)},o(r){Ae(t.$$.fragment,r),n=!1},d(r){Wt(t,r)}}}function Gu(e){let t,n;return t=new Cu({props:{transType:e[2]}}),{c(){Vt(t.$$.fragment)},l(r){jt(t.$$.fragment,r)},m(r,i){qt(t,r,i),n=!0},p(r,i){const s={};i&4&&(s.transType=r[2]),t.$set(s)},i(r){n||(me(t.$$.fragment,r),n=!0)},o(r){Ae(t.$$.fragment,r),n=!1},d(r){Wt(t,r)}}}function Zu(e){let t,n;return t=new xu({}),{c(){Vt(t.$$.fragment)},l(r){jt(t.$$.fragment,r)},m(r,i){qt(t,r,i),n=!0},p:ce,i(r){n||(me(t.$$.fragment,r),n=!0)},o(r){Ae(t.$$.fragment,r),n=!1},d(r){Wt(t,r)}}}function Ju(e){let t,n,r,i,s,o,a,c,l,u,f,p,d,y,h,m,S,v,_,T,k,U,ee,R;const Z=[ju,Vu],G=[];function O(N,P){return N[5].isSignedIn?0:1}return l=O(e),u=G[l]=Z[l](e),{c(){t=E("section"),n=E("img"),i=j(),s=E("div"),o=E("h1"),a=K("City Coins Test Application"),c=j(),u.c(),f=j(),p=E("div"),d=E("div"),y=E("div"),h=j(),m=E("div"),S=E("span"),v=E("img"),T=j(),k=E("div"),this.h()},l(N){t=A(N,"SECTION",{id:!0,style:!0,class:!0});var P=$(t);n=A(P,"IMG",{src:!0,alt:!0,style:!0}),i=q(P),s=A(P,"DIV",{class:!0});var V=$(s);o=A(V,"H1",{class:!0});var D=$(o);a=L(D,"City Coins Test Application"),D.forEach(b),c=q(V),u.l(V),V.forEach(b),f=q(P),p=A(P,"DIV",{class:!0});var Y=$(p);d=A(Y,"DIV",{class:!0});var H=$(d);y=A(H,"DIV",{}),$(y).forEach(b),h=q(H),m=A(H,"DIV",{});var fe=$(m);S=A(fe,"SPAN",{class:!0});var le=$(S);v=A(le,"IMG",{src:!0,alt:!0,width:!0,height:!0}),le.forEach(b),fe.forEach(b),T=q(H),k=A(H,"DIV",{}),$(k).forEach(b),H.forEach(b),Y.forEach(b),P.forEach(b),this.h()},h(){mr(n.src,r=Mu)||x(n,"src",r),x(n,"alt","night time"),et(n,"min-height","100%"),et(n,"min-width","100%"),et(n,"object-fit","cover"),x(o,"class","svelte-xcchip"),x(s,"class","content svelte-xcchip"),mr(v.src,_=zu)||x(v,"src",_),x(v,"alt","Scroll down"),x(v,"width","30"),x(v,"height","auto"),x(S,"class","pointer"),x(d,"class","d-flex justify-content-between"),x(p,"class","section-footer svelte-xcchip"),x(t,"id","section1"),x(t,"style",""),x(t,"class","svelte-xcchip")},m(N,P){se(N,t,P),g(t,n),g(t,i),g(t,s),g(s,o),g(o,a),g(s,c),G[l].m(s,null),g(t,f),g(t,p),g(p,d),g(d,y),g(d,h),g(d,m),g(m,S),g(S,v),g(d,T),g(d,k),U=!0,ee||(R=ge(S,"click",e[8]),ee=!0)},p(N,[P]){let V=l;l=O(N),l===V?G[l].p(N,P):(Ln(),Ae(G[V],1,1,()=>{G[V]=null}),Fn(),u=G[l],u?u.p(N,P):(u=G[l]=Z[l](N),u.c()),me(u,1),u.m(s,null))},i(N){U||(me(u),U=!0)},o(N){Ae(u),U=!1},d(N){N&&b(t),G[l].d(),ee=!1,R()}}}function Xu(e,t,n){let r;const i=ls();Ve(e,i,h=>n(5,r=h));const s="mainnet";let o,a,c;const l=()=>{const h=document.getElementById("footer-section");h&&h.scrollIntoView({behavior:"smooth"})};let u=0,f=0;ys(async()=>{n(3,u=await Fu()),n(4,f=await Lu())});function p(){a=an(this),n(1,a)}function d(){o=an(this),n(0,o)}function y(){c=an(this),n(2,c)}return[o,a,c,u,f,r,i,s,l,p,d,y]}class rf extends xt{constructor(t){super(),Et(this,t,Xu,Ju,At,{})}}export{ls as C,rf as S,ur as a,tn as b,nf as f,tf as s};
